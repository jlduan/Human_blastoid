<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Jialei Duan">
<title>Human blastoid - Comparative Analysis of Single Cell Transcriptomes of Human Blastoids</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./miscellaneous.html" rel="next">
<link href="./analyze_blastoids.html" rel="prev">
<link href="./logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SKHX1FQV8F"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SKHX1FQV8F', { 'anonymize_ip': true});
</script><link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Human blastoid - Comparative Analysis of Single Cell Transcriptomes of Human Blastoids">
<meta property="og:description" content="Human blastoids provide a readily accessible, scalable, versatile and perturbable alternative to blastocysts for studying early human development, understanding early pregnancy loss and gaining…">
<meta property="og:image" content="https://jlduan.github.io/Human_blastoid/docs/schematic_summary.png">
<meta property="og:site-name" content="Human_blastoid">
<meta name="twitter:title" content="Blastocyst-like structures generated from human pluripotent stem cells">
<meta name="twitter:description" content="Human blastoids provide a readily accessible, scalable, versatile and perturbable alternative to blastocysts for studying early human development, understanding early pregnancy loss and gaining…">
<meta name="twitter:image" content="https://jlduan.github.io/Human_blastoid/docs/schematic_summary.png">
<meta name="twitter:creator" content="@jlduan">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="Blastocyst-like structures generated from human pluripotent stem cells">
<meta name="citation_abstract" content="Human blastoids provide a readily accessible, scalable, versatile and perturbable alternative to blastocysts for studying early human development, understanding early pregnancy loss and gaining insights into early developmental defects.
">
<meta name="citation_author" content="Leqian Yu">
<meta name="citation_author" content="Yulei Wei">
<meta name="citation_author" content="Jialei Duan">
<meta name="citation_author" content="Daniel A. Schmitz">
<meta name="citation_author" content="Masahiro Sakurai">
<meta name="citation_author" content="Lei Wang">
<meta name="citation_author" content="Kunhua Wang">
<meta name="citation_author" content="Shuhua Zhao">
<meta name="citation_author" content="Gary C. Hon">
<meta name="citation_author" content="Jun Wu">
<meta name="citation_publication_date" content="2022-09-24">
<meta name="citation_cover_date" content="2022-09-24">
<meta name="citation_year" content="2022">
<meta name="citation_online_date" content="2022-03-17">
<meta name="citation_fulltext_html_url" content="https://doi.org/10.1038/s41586-021-03356-y">
<meta name="citation_issue" content="7851">
<meta name="citation_doi" content="10.1038/s41586-021-03356-y">
<meta name="citation_pmid" content="33731924">
<meta name="citation_volume" content="591">
<meta name="citation_language" content="en">
<meta name="citation_firstpage" content="620">
<meta name="citation_lastpage" content="626">
<meta name="citation_journal_title" content="Nature">
<meta name="citation_publisher" content="Nature Publishing Group">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Comparative Analysis of Single Cell Transcriptomes of Human Blastoids</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-center sidebar-header sidebar-header-stacked">
      <a href="./" class="sidebar-logo-link">
      <img src="./logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./"><strong>Human blastoid</strong></a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/jlduan" title="Human blastoid" class="sidebar-tool px-1"><i class="bi bi-globe"></i></a>
    <a href="" title="GitHub" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-github"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
<li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/jlduan/Human_blastoid">
          Source Code
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/jlduan/Human_blastoid/issues">
          Report a Bug
          </a>
        </li>
    </ul>
<a href="https://twitter.com/jlduan" title="Twitter" class="sidebar-tool px-1"><i class="bi bi-twitter"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preprocess_matrices.html" class="sidebar-item-text sidebar-link">Preprocess</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cluster_blastoids.html" class="sidebar-item-text sidebar-link">Cluster</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analyze_blastoids.html" class="sidebar-item-text sidebar-link">Interpret</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./compare_blastoids.html" class="sidebar-item-text sidebar-link active">Compare</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./miscellaneous.html" class="sidebar-item-text sidebar-link">Miscellaneous</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#preparation" id="toc-preparation" class="nav-link active" data-scroll-target="#preparation">Preparation</a>
  <ul>
<li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions">Functions</a></li>
  <li><a href="#python-env" id="toc-python-env" class="nav-link" data-scroll-target="#python-env">Python env</a></li>
  <li><a href="#matrix" id="toc-matrix" class="nav-link" data-scroll-target="#matrix">Matrix</a></li>
  <li><a href="#embedding" id="toc-embedding" class="nav-link" data-scroll-target="#embedding">Embedding</a></li>
  <li><a href="#metadata" id="toc-metadata" class="nav-link" data-scroll-target="#metadata">Metadata</a></li>
  </ul>
</li>
  <li>
<a href="#prepost-implantation-comparison" id="toc-prepost-implantation-comparison" class="nav-link" data-scroll-target="#prepost-implantation-comparison">Pre/post-implantation comparison</a>
  <ul>
<li><a href="#blastoid" id="toc-blastoid" class="nav-link" data-scroll-target="#blastoid">Blastoid</a></li>
  <li>
<a href="#public-datasets" id="toc-public-datasets" class="nav-link" data-scroll-target="#public-datasets">Public datasets</a>
  <ul class="collapse">
<li><a href="#petropoulos-et-al" id="toc-petropoulos-et-al" class="nav-link" data-scroll-target="#petropoulos-et-al">Petropoulos et al</a></li>
  <li><a href="#xiang-et-al" id="toc-xiang-et-al" class="nav-link" data-scroll-target="#xiang-et-al">Xiang et al</a></li>
  <li><a href="#zhou-et-al" id="toc-zhou-et-al" class="nav-link" data-scroll-target="#zhou-et-al">Zhou et al</a></li>
  <li><a href="#takashima-et-al" id="toc-takashima-et-al" class="nav-link" data-scroll-target="#takashima-et-al">Takashima et al</a></li>
  <li><a href="#dong-et-al" id="toc-dong-et-al" class="nav-link" data-scroll-target="#dong-et-al">Dong et al</a></li>
  <li><a href="#cinkornpumin-et-al" id="toc-cinkornpumin-et-al" class="nav-link" data-scroll-target="#cinkornpumin-et-al">Cinkornpumin et al</a></li>
  <li><a href="#lv-et-al" id="toc-lv-et-al" class="nav-link" data-scroll-target="#lv-et-al">Lv et al</a></li>
  <li><a href="#linneberg-agerholm-et-al" id="toc-linneberg-agerholm-et-al" class="nav-link" data-scroll-target="#linneberg-agerholm-et-al">Linneberg-Agerholm et al</a></li>
  </ul>
</li>
  <li>
<a href="#principal-component-analysis" id="toc-principal-component-analysis" class="nav-link" data-scroll-target="#principal-component-analysis">Principal component analysis</a>
  <ul class="collapse">
<li><a href="#epi" id="toc-epi" class="nav-link" data-scroll-target="#epi">EPI</a></li>
  <li><a href="#te" id="toc-te" class="nav-link" data-scroll-target="#te">TE</a></li>
  <li><a href="#hyp" id="toc-hyp" class="nav-link" data-scroll-target="#hyp">HYP</a></li>
  <li><a href="#visualization-joint" id="toc-visualization-joint" class="nav-link" data-scroll-target="#visualization-joint">Visualization, joint</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#comparison-w-cynomolgus-monkeys" id="toc-comparison-w-cynomolgus-monkeys" class="nav-link" data-scroll-target="#comparison-w-cynomolgus-monkeys">Comparison w/ cynomolgus monkeys</a>
  <ul>
<li><a href="#data-loading" id="toc-data-loading" class="nav-link" data-scroll-target="#data-loading">Data loading</a></li>
  <li><a href="#correlation-heatmap" id="toc-correlation-heatmap" class="nav-link" data-scroll-target="#correlation-heatmap">Correlation heatmap</a></li>
  </ul>
</li>
  <li>
<a href="#derived-stem-cells" id="toc-derived-stem-cells" class="nav-link" data-scroll-target="#derived-stem-cells">Derived stem cells</a>
  <ul>
<li><a href="#data-loading-1" id="toc-data-loading-1" class="nav-link" data-scroll-target="#data-loading-1">Data loading</a></li>
  <li><a href="#correlation-heatmap-1" id="toc-correlation-heatmap-1" class="nav-link" data-scroll-target="#correlation-heatmap-1">Correlation heatmap</a></li>
  </ul>
</li>
  <li><a href="#r-session-info" id="toc-r-session-info" class="nav-link" data-scroll-target="#r-session-info">R session info</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">Comparative Analysis of Single Cell Transcriptomes of Human Blastoids</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jialei Duan <a href="https://orcid.org/0000-0003-4086-7461" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Sat Sep 24, 2022 22:07:15-05:00</p>
    </div>
  </div>
  
    
    <div>
    <div class="quarto-title-meta-heading">Doi</div>
    <div class="quarto-title-meta-contents">
      <p class="doi">
        <a href="https://doi.org/10.5281/zenodo.7110557">10.5281/zenodo.7110557</a>
      </p>
    </div>
  </div>
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    <p>Human blastoids provide a readily accessible, scalable, versatile and perturbable alternative to blastocysts for studying early human development, understanding early pregnancy loss and gaining insights into early developmental defects.</p>
  </div>
</div>

</header><p><br></p>
<p>In this manuscript, several transcriptome data sets generated by different technologies were included. To minimize platform and processing differences, raw fastq files of public datasets using the Illumina sequencing platform were downloaded and re-processed.</p>
<ul>
<li>Cinkornpumin, J.K., Kwon, S.Y., Guo, Y., Hossain, I., Sirois, J., Russett, C.S., Tseng, H.-W., Okae, H., Arima, T., Duchaine, T.F., et al.&nbsp;(2020). <strong><a href="https://jlduan.github.io/replica/j.stemcr.2020.06.003/">Naive human embryonic stem cells can give rise to cells with a trophoblast-like transcriptome and methylome</a></strong>. Stem Cell Reports 15, 198–213.</li>
<li>Dong, C., Beltcheva, M., Gontarz, P., Zhang, B., Popli, P., Fischer, L.A., Khan, S.A., Park, K.-M., Yoon, E.-J., Xing, X., et al.&nbsp;(2020). <strong><a href="https://jlduan.github.io/replica/eLife.52504">Derivation of trophoblast stem cells from naïve human pluripotent stem cells</a></strong>. Elife 9.</li>
<li>Linneberg-Agerholm, M., Wong, Y.F., Romero Herrera, J.A., Monteiro, R.S., Anderson, K.G.V., and Brickman, J.M. (2019). <strong><a href="https://jlduan.github.io/replica/dev.180620/">Naïve human pluripotent stem cells respond to Wnt, Nodal and LIF signalling to produce expandable naïve extra-embryonic endoderm</a></strong>. Development 146.</li>
<li>Lv, B., An, Q., Zeng, Q., Zhang, X., Lu, P., Wang, Y., Zhu, X., Ji, Y., Fan, G., and Xue, Z. (2019). <strong><a href="https://jlduan.github.io/replica/journal.pbio.3000187">Single-cell RNA sequencing reveals regulatory mechanism for trophoblast cell-fate divergence in human peri-implantation conceptuses</a></strong>. PLoS Biol. 17, e3000187.</li>
<li>Nakamura, T., Okamoto, I., Sasaki, K., Yabuta, Y., Iwatani, C., Tsuchiya, H., Seita, Y., Nakamura, S., Yamamoto, T., and Saitou, M. (2016). <strong><a href="https://jlduan.github.io/replica/nature19096">A developmental coordinate of pluripotency among mice, monkeys and humans</a></strong>. Nature 537, 57–62.</li>
<li>Petropoulos, S., Edsgärd, D., Reinius, B., Deng, Q., Panula, S.P., Codeluppi, S., Plaza Reyes, A., Linnarsson, S., Sandberg, R., and Lanner, F. (2016). <strong><a href="https://jlduan.github.io/replica/j.cell.2016.03.023">Single-cell RNA-Seq reveals lineage and X chromosome dynamics in human preimplantation embryos</a></strong>. Cell 165, 1012–1026.</li>
<li>Takashima, Y., Guo, G., Loos, R., Nichols, J., Ficz, G., Krueger, F., Oxley, D., Santos, F., Clarke, J., Mansfield, W., et al.&nbsp;(2014). <strong><a href="https://jlduan.github.io/replica/j.cell.2014.08.029">Resetting transcription factor control circuitry toward ground-state pluripotency in human</a></strong>. Cell 158, 1254–1269.</li>
<li>Xiang, L., Yin, Y., Zheng, Y., Ma, Y., Li, Y., Zhao, Z., Guo, J., Ai, Z., Niu, Y., Duan, K., et al.&nbsp;(2020). <strong><a href="https://jlduan.github.io/replica/s41586-019-1875-y/">A developmental landscape of 3D-cultured human pre-gastrulation embryos</a></strong>. Nature 577, 537–542.</li>
<li>Zhou, F., Wang, R., Yuan, P., Ren, Y., Mao, Y., Li, R., Lian, Y., Li, J., Wen, L., Yan, L., et al.&nbsp;(2019). <strong><a href="https://jlduan.github.io/replica/s41586-019-1500-0">Reconstituting the transcriptome and DNA methylome landscapes of human implantation</a></strong>. Nature 572, 660–664.</li>
</ul>
<p><br></p>
<hr>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022-09-24 22:06:31 CDT"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/timezones.html">Sys.timezone</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "America/Chicago"</code></pre>
</div>
</div>
<section id="preparation" class="level2"><h2 class="anchored" data-anchor-id="preparation">Preparation</h2>
<section id="functions" class="level3"><h3 class="anchored" data-anchor-id="functions">Functions</h3>
<div class="cell">

</div>
<p>Load required packages.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org/">Matrix</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wch/extrafont">extrafont</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">SCRIPT_DIR</span>,</span>
<span>        <span class="st">"utilities.R"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">load_matrix</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">matrix_readcount_use</span> <span class="op">&lt;-</span> <span class="va">scipy</span><span class="op">$</span><span class="va">sparse</span><span class="op">$</span><span class="fu">load_npz</span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"matrix_readcount.npz"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">np</span><span class="op">$</span><span class="fu">load</span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"matrix_readcount_barcodes.npy"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">np</span><span class="op">$</span><span class="fu">load</span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"matrix_readcount_features.npy"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">perform_pca</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">matrix</span>, <span class="va">features</span>, <span class="va">min_counts</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">matrix_norm</span> <span class="op">&lt;-</span> <span class="va">matrix</span><span class="op">[</span></span>
<span>        <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span></span>
<span>            <span class="va">matrix</span></span>
<span>        <span class="op">)</span> <span class="op">&gt;=</span> <span class="va">min_counts</span>,</span>
<span>    <span class="op">]</span></span>
<span></span>
<span>    <span class="va">matrix_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">matrix_norm</span>, <span class="st">"dgCMatrix"</span><span class="op">)</span></span>
<span>    <span class="va">matrix_norm</span><span class="op">@</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">matrix_norm</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span></span>
<span>        <span class="op">(</span><span class="va">matrix_norm</span><span class="op">@</span><span class="va">x</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">matrix_norm</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">matrix_norm</span><span class="op">@</span><span class="va">p</span><span class="op">)</span></span>
<span>        <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">matrix_norm_log</span> <span class="op">&lt;-</span> <span class="va">matrix_norm</span><span class="op">[</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_norm</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">features</span>,</span>
<span>    <span class="op">]</span></span>
<span>    <span class="va">matrix_norm_log</span><span class="op">@</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log1p</a></span><span class="op">(</span><span class="va">matrix_norm_log</span><span class="op">@</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># z-score</span></span>
<span>    <span class="va">matrix_norm_log_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span></span>
<span>                <span class="va">matrix_norm_log</span></span>
<span>            <span class="op">)</span>,</span>
<span>            center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># PCA</span></span>
<span>    <span class="va">pca_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">matrix_norm_log_scaled</span><span class="op">)</span>,</span>
<span>        center <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        scale <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">pca_out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
</section><section id="python-env" class="level3"><h3 class="anchored" data-anchor-id="python-env">Python env</h3>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">np</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html">import</a></span><span class="op">(</span><span class="st">"numpy"</span>, convert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">scipy</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html">import</a></span><span class="op">(</span>module <span class="op">=</span> <span class="st">"scipy"</span>, convert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ad</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html">import</a></span><span class="op">(</span>module <span class="op">=</span> <span class="st">"anndata"</span>, convert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_config.html">py_config</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>python:         /Users/jialei/.pyenv/shims/python
libpython:      /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/libpython3.9.dylib
pythonhome:     /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10:/Users/jialei/.pyenv/versions/mambaforge-4.10.3-10
version:        3.9.13 | packaged by conda-forge | (main, May 27 2022, 17:00:33)  [Clang 13.0.1 ]
numpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy
numpy_version:  1.22.4
numpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy

NOTE: Python version was forced by RETICULATE_PYTHON</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"numpy:"</span>, <span class="va">np</span><span class="op">$</span><span class="va">`__version__`</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">## numpy: 1.22.4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"scipy:"</span>, <span class="va">scipy</span><span class="op">$</span><span class="va">`__version__`</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">## scipy: 1.9.1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"anndata:"</span>, <span class="va">ad</span><span class="op">$</span><span class="va">`__version__`</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">## anndata: 0.8.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PROJECT_DIR</span> <span class="op">&lt;-</span> <span class="st">"/Users/jialei/Dropbox/Data/Projects/UTSW/Human_blastoid"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="matrix" class="level3"><h3 class="anchored" data-anchor-id="matrix">Matrix</h3>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MATRIX_DIR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"github/data/matrices/LW36"</span>,</span>
<span>    <span class="st">"github/data/matrices/LW49_LW50_LW51_LW52"</span>,</span>
<span>    <span class="st">"github/data/matrices/LW58_LW59"</span>,</span>
<span>    <span class="st">"github/data/matrices/LW60_LW61"</span>,</span>
<span>    <span class="st">"raw/public/PRJEB11202/reformatted_matrix"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_use</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">MATRIX_DIR</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">load_matrix</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">PROJECT_DIR</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># clean up</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">MATRIX_DIR</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="embedding" class="level3"><h3 class="anchored" data-anchor-id="embedding">Embedding</h3>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">EMBEDDING_FILE</span> <span class="op">&lt;-</span> <span class="st">"embedding.csv.gz"</span></span>
<span></span>
<span><span class="va">embedding</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"github"</span>,</span>
<span>        <span class="st">"data"</span>,</span>
<span>        <span class="va">EMBEDDING_FILE</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># clean up</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">EMBEDDING_FILE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="metadata" class="level3"><h3 class="anchored" data-anchor-id="metadata">Metadata</h3>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cell_metadata_PRJEB11202</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"raw/public/PRJEB11202/"</span>,</span>
<span>        <span class="st">"E-MTAB-3929.sdrf.tsv"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"\t"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>        <span class="va">`Comment[ENA_SAMPLE]`</span>,</span>
<span>        <span class="va">`Comment[ENA_RUN]`</span>,</span>
<span>        <span class="va">`Characteristics[developmental stage]`</span>,</span>
<span>        <span class="va">`Characteristics[inferred lineage]`</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span></span>
<span>        cell <span class="op">=</span> <span class="va">`Comment[ENA_SAMPLE]`</span>,</span>
<span>        run <span class="op">=</span> <span class="va">`Comment[ENA_RUN]`</span>,</span>
<span>        developmental_stage <span class="op">=</span> <span class="va">`Characteristics[developmental stage]`</span>,</span>
<span>        lineage <span class="op">=</span> <span class="va">`Characteristics[inferred lineage]`</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        developmental_stage <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span></span>
<span>            string <span class="op">=</span> <span class="va">developmental_stage</span>,</span>
<span>            pattern <span class="op">=</span> <span class="st">"embryonic day "</span>,</span>
<span>            replacement <span class="op">=</span> <span class="st">"E"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        lineage <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>            <span class="va">lineage</span> <span class="op">==</span> <span class="st">"epiblast"</span> <span class="op">~</span> <span class="st">"EPI"</span>,</span>
<span>            <span class="va">lineage</span> <span class="op">==</span> <span class="st">"primitive endoderm"</span> <span class="op">~</span> <span class="st">"HYP"</span>,</span>
<span>            <span class="va">lineage</span> <span class="op">==</span> <span class="st">"trophectoderm"</span> <span class="op">~</span> <span class="st">"TE"</span>,</span>
<span>            <span class="va">lineage</span> <span class="op">==</span> <span class="st">"not applicable"</span> <span class="op">~</span> <span class="st">"Pre-lineage"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">embedding</span> <span class="op">&lt;-</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span></span>
<span>        <span class="va">cell_metadata_PRJEB11202</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        lineage <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">lineage</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Blastoid"</span>,</span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">lineage</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        developmental_stage <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">developmental_stage</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Blastoid"</span>,</span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">developmental_stage</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">walk</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html">object.size</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">"auto"</span>, standard <span class="op">=</span> <span class="st">"SI"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.6 GB</code></pre>
</div>
</div>
</section></section><section id="prepost-implantation-comparison" class="level2"><h2 class="anchored" data-anchor-id="prepost-implantation-comparison">Pre/post-implantation comparison</h2>
<div class="cell">

</div>
<section id="blastoid" class="level3"><h3 class="anchored" data-anchor-id="blastoid">Blastoid</h3>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_blastoid_pseudobulk</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">embedding</span><span class="op">$</span><span class="va">louvain</span><span class="op">)</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">louvain</span> <span class="op">==</span> <span class="va">x</span>,</span>
<span>                <span class="va">batch</span> <span class="op">!=</span> <span class="st">"PRJEB11202"</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">embedding</span><span class="op">$</span><span class="va">louvain</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">EMBEDDING_FILE</span> <span class="op">&lt;-</span> <span class="st">"embedding_stem.csv.gz"</span></span>
<span></span>
<span><span class="va">embedding_stem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"github"</span>,</span>
<span>        <span class="st">"data"</span>,</span>
<span>        <span class="va">EMBEDDING_FILE</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_stem_pseudobulk</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">embedding_stem</span><span class="op">$</span><span class="va">batch</span><span class="op">)</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">embedding_stem</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">batch</span> <span class="op">==</span> <span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">embedding_stem</span><span class="op">$</span><span class="va">batch</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="public-datasets" class="level3"><h3 class="anchored" data-anchor-id="public-datasets">Public datasets</h3>
<section id="petropoulos-et-al" class="level4"><h4 class="anchored" data-anchor-id="petropoulos-et-al">Petropoulos et al</h4>
<p><a href="https://doi.org/10.1016/j.cell.2016.03.023">Single-cell RNA-Seq reveals lineage and X chromosome dynamics in human preimplantation embryos</a></p>
<ul>
<li>BioProject Accession: PRJEB11202</li>
<li>ArrayExpress: E-MTAB-3929</li>
<li>Notebook: <a href="https://jlduan.github.io/replica/j.cell.2016.03.023">https://jlduan.github.io/replica/j.cell.2016.03.023</a>
</li>
</ul>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_PRJEB11202_pseudobulk_EPI</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"E5"</span>, <span class="st">"E6"</span>, <span class="st">"E7"</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">lineage</span> <span class="op">==</span> <span class="st">"EPI"</span>,</span>
<span>                <span class="va">developmental_stage</span> <span class="op">==</span> <span class="va">x</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"E5"</span>, <span class="st">"E6"</span>, <span class="st">"E7"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_PRJEB11202_pseudobulk_TE</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"E5"</span>, <span class="st">"E6"</span>, <span class="st">"E7"</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">lineage</span> <span class="op">==</span> <span class="st">"TE"</span>,</span>
<span>                <span class="va">developmental_stage</span> <span class="op">==</span> <span class="va">x</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"E5"</span>, <span class="st">"E6"</span>, <span class="st">"E7"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_PRJEB11202_pseudobulk_HYP</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"E5"</span>, <span class="st">"E6"</span>, <span class="st">"E7"</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">lineage</span> <span class="op">==</span> <span class="st">"HYP"</span>,</span>
<span>                <span class="va">developmental_stage</span> <span class="op">==</span> <span class="va">x</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"E5"</span>, <span class="st">"E6"</span>, <span class="st">"E7"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="xiang-et-al" class="level4"><h4 class="anchored" data-anchor-id="xiang-et-al">Xiang et al</h4>
<p><a href="https://doi.org/10.1038/s41586-019-1875-y">A developmental landscape of 3D-cultured human pre-gastrulation embryos</a></p>
<ul>
<li>BioProject Accession: PRJNA562548</li>
<li>GEO Accession: GSE136447</li>
<li>Notebook: <a href="https://jlduan.github.io/replica/s41586-019-1875-y">https://jlduan.github.io/replica/s41586-019-1875-y</a>
</li>
</ul>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">adata_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">MATRIX_DIR</span>,</span>
<span>        <span class="st">"adata.h5ad"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">BACKED</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">matrix_readcount_PRJNA562548</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">adata_files</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ad</span><span class="op">$</span><span class="fu">read_h5ad</span><span class="op">(</span></span>
<span>        filename <span class="op">=</span> <span class="va">x</span>, backed <span class="op">=</span> <span class="va">BACKED</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">convert_adata</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cell_metadata_PRJNA562548</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">MATRIX_DIR</span>, <span class="st">"cell_metadata.csv"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>        cell <span class="op">=</span> <span class="va">`Sample Name`</span>,</span>
<span>        developmental_stage <span class="op">=</span> <span class="va">Age</span>,</span>
<span>        lineage <span class="op">=</span> <span class="va">Cell_type</span>,</span>
<span>        run <span class="op">=</span> <span class="va">Run</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        developmental_stage <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span></span>
<span>            string <span class="op">=</span> <span class="va">developmental_stage</span>,</span>
<span>            pattern <span class="op">=</span> <span class="st">"embryo invitro day "</span>,</span>
<span>            replacement <span class="op">=</span> <span class="st">"E"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        developmental_stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">developmental_stage</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_order.html">str_sort</a></span><span class="op">(</span></span>
<span>                x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">developmental_stage</span><span class="op">)</span>,</span>
<span>                numeric <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        lineage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">lineage</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="st">"ICM"</span>,</span>
<span>                <span class="st">"EPI"</span>,</span>
<span>                <span class="st">"PSA-EPI"</span>,</span>
<span>                <span class="st">"Hypoblast"</span>,</span>
<span>                <span class="st">"CTBs"</span>,</span>
<span>                <span class="st">"STBs"</span>,</span>
<span>                <span class="st">"EVTs"</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_PRJNA562548_pseudobulk_EPI</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA562548</span><span class="op">$</span><span class="va">developmental_stage</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">cell_metadata_PRJNA562548</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">lineage</span> <span class="op">==</span> <span class="st">"EPI"</span>,</span>
<span>                <span class="va">developmental_stage</span> <span class="op">==</span> <span class="va">x</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA562548</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA562548</span><span class="op">$</span><span class="va">developmental_stage</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_PRJNA562548_pseudobulk_HYP</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA562548</span><span class="op">$</span><span class="va">developmental_stage</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">cell_metadata_PRJNA562548</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">lineage</span> <span class="op">==</span> <span class="st">"Hypoblast"</span>,</span>
<span>                <span class="va">developmental_stage</span> <span class="op">==</span> <span class="va">x</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cells_in_group</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA562548</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">m</span> <span class="op">&lt;-</span> <span class="va">matrix_readcount_PRJNA562548</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span></span>
<span>        <span class="op">}</span></span>
<span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span></span>
<span>        <span class="va">cell_metadata_PRJNA562548</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">lineage</span> <span class="op">==</span> <span class="st">"Hypoblast"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">developmental_stage</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># clean up</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA562548</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA562548</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="zhou-et-al" class="level4"><h4 class="anchored" data-anchor-id="zhou-et-al">Zhou et al</h4>
<p><a href="https://doi.org/10.1038/s41586-019-1500-0">Reconstituting the transcriptome and DNA methylome landscapes of human implantation</a></p>
<ul>
<li>BioProject Accession: PRJNA431392</li>
<li>GEO Accession: GSE109555</li>
<li>Notebook: <a href="https://jlduan.github.io/replica/s41586-019-1500-0">https://jlduan.github.io/replica/s41586-019-1500-0</a>
</li>
</ul>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">adata_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">MATRIX_DIR</span>,</span>
<span>        <span class="st">"adata.h5ad"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">BACKED</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">matrix_readcount_PRJNA431392</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">adata_files</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ad</span><span class="op">$</span><span class="fu">read_h5ad</span><span class="op">(</span></span>
<span>        filename <span class="op">=</span> <span class="va">x</span>, backed <span class="op">=</span> <span class="va">BACKED</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">convert_adata</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">embryos_selected_PRJNA431392</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"ha_D6_E2"</span>,</span>
<span>    <span class="st">"hm_D6_E1"</span>,</span>
<span>    <span class="st">"hm_D6_E2"</span>,</span>
<span>    <span class="st">"hm_D8_E2"</span>,</span>
<span>    <span class="st">"hm_D8_E3"</span>,</span>
<span>    <span class="st">"hm_D8_E5"</span>,</span>
<span>    <span class="st">"ha_D8_E1"</span>,</span>
<span>    <span class="st">"hm_D8_E1"</span>,</span>
<span>    <span class="st">"hv_D8_E1"</span>,</span>
<span>    <span class="st">"hv_D8_E2"</span>,</span>
<span>    <span class="st">"hv_D8_E3"</span>,</span>
<span>    <span class="st">"hv_D10_E6"</span>,</span>
<span>    <span class="st">"ha_D10_E1"</span>,</span>
<span>    <span class="st">"ha_D10_E2"</span>,</span>
<span>    <span class="st">"hm_D10_E4"</span>,</span>
<span>    <span class="st">"hm_D10_E9"</span>,</span>
<span>    <span class="st">"hv_D10_E7"</span>,</span>
<span>    <span class="st">"hv_D10_E8"</span>,</span>
<span>    <span class="st">"ha_D12_E1"</span>,</span>
<span>    <span class="st">"hv_D12_E1"</span>,</span>
<span>    <span class="st">"hv_D12_E2"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cell_metadata_PRJNA431392</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">MATRIX_DIR</span>, <span class="st">"cell_metadata.csv"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        developmental_stage <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span></span>
<span>            string <span class="op">=</span> <span class="va">Day</span>,</span>
<span>            pattern <span class="op">=</span> <span class="st">"D"</span>,</span>
<span>            replacement <span class="op">=</span> <span class="st">"E"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        developmental_stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">developmental_stage</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_order.html">str_sort</a></span><span class="op">(</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">developmental_stage</span><span class="op">)</span>,</span>
<span>                numeric <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        lineage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">Lineage</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="st">"EPI"</span>,</span>
<span>                <span class="st">"PE"</span>,</span>
<span>                <span class="st">"TE"</span>,</span>
<span>                <span class="st">"MIX"</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        `3184` <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>            <span class="va">Ori_Day_Emb</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">embryos_selected_PRJNA431392</span> <span class="op">~</span> <span class="st">"1"</span>,</span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"0"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>cell <span class="op">=</span> <span class="va">Sample</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cell_metadata_PRJNA431392</span> <span class="op">&lt;-</span> <span class="va">cell_metadata_PRJNA431392</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">`3184`</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>developmental_stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="va">developmental_stage</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_PRJNA431392_pseudobulk_EPI</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA431392</span><span class="op">$</span><span class="va">developmental_stage</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">cell_metadata_PRJNA431392</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">developmental_stage</span> <span class="op">==</span> <span class="va">x</span>,</span>
<span>                <span class="va">lineage</span> <span class="op">==</span> <span class="st">"EPI"</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA431392</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA431392</span><span class="op">$</span><span class="va">developmental_stage</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_PRJNA431392_pseudobulk_TE</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA431392</span><span class="op">$</span><span class="va">developmental_stage</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">cell_metadata_PRJNA431392</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">developmental_stage</span> <span class="op">==</span> <span class="va">x</span>,</span>
<span>                <span class="va">lineage</span> <span class="op">==</span> <span class="st">"TE"</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA431392</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA431392</span><span class="op">$</span><span class="va">developmental_stage</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_PRJNA431392_pseudobulk_HYP</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA431392</span><span class="op">$</span><span class="va">developmental_stage</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">cell_metadata_PRJNA431392</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">developmental_stage</span> <span class="op">==</span> <span class="va">x</span>,</span>
<span>                <span class="va">lineage</span> <span class="op">==</span> <span class="st">"PE"</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA431392</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA431392</span><span class="op">$</span><span class="va">developmental_stage</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># clean up</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA431392</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA431392</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="takashima-et-al" class="level4"><h4 class="anchored" data-anchor-id="takashima-et-al">Takashima et al</h4>
<p><a href="https://doi.org/10.1016/j.cell.2014.08.029">Resetting transcription factor control circuitry toward ground-state pluripotency in human</a></p>
<ul>
<li>BioProject Accession: PRJEB7132</li>
<li>ArrayExpress Accession: E-MTAB-2857</li>
<li>Notebook: <a href="https://jlduan.github.io/replica/j.cell.2014.08.029">https://jlduan.github.io/replica/j.cell.2014.08.029</a>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_PRJEB7132</span> <span class="op">&lt;-</span> <span class="fu">load_matrix</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">PROJECT_DIR</span>, <span class="st">"raw/public/PRJEB7132"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_PRJEB7132_pseudobulk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>    H9 <span class="op">=</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span></span>
<span>        <span class="va">matrix_readcount_PRJEB7132</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ERS537888"</span>, <span class="st">"ERS537890"</span>, <span class="st">"ERS537878"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="op">)</span>,</span>
<span>    H9_reset <span class="op">=</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span></span>
<span>        <span class="va">matrix_readcount_PRJEB7132</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ERS537884"</span>, <span class="st">"ERS537881"</span>, <span class="st">"ERS537876"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># clean up</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJEB7132</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="dong-et-al" class="level4"><h4 class="anchored" data-anchor-id="dong-et-al">Dong et al</h4>
<p><a href="https://doi.org/10.7554/eLife.52504">Derivation of trophoblast stem cells from naïve human pluripotent stem cells</a></p>
<ul>
<li>BioProject Accession: PRJNA576801</li>
<li>GEO Accession: GSE138688</li>
<li>Notebook: <a href="https://jlduan.github.io/replica/eLife.52504">https://jlduan.github.io/replica/eLife.52504</a>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_PRJNA576801</span> <span class="op">&lt;-</span> <span class="fu">load_matrix</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">PROJECT_DIR</span>, <span class="st">"raw/public/PRJNA576801"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_info_PRJNA576801</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">sample_name</span>, <span class="op">~</span><span class="va">sample_annotation</span>, <span class="op">~</span><span class="va">group</span>, <span class="op">~</span><span class="va">cell_line</span>,</span>
<span>    <span class="co"># "GSM4116149", "H9 primed TSC Bulk RNA-seq", "Primed hPSC (hTSC medium)", "H9",</span></span>
<span>    <span class="co"># "GSM4116150", "AN primed TSC Bulk RNA-seq", "Primed hPSC (hTSC medium)", "AN",</span></span>
<span>    <span class="st">"GSM4116151"</span>, <span class="st">"H9 primed Bulk RNA-seq"</span>, <span class="st">"Primed hPSC"</span>, <span class="st">"H9"</span>,</span>
<span>    <span class="st">"GSM4116152"</span>, <span class="st">"AN primed Bulk RNA-seq"</span>, <span class="st">"Primed hPSC"</span>, <span class="st">"AN"</span>,</span>
<span>    <span class="co"># "GSM4116153", "H9 primed StemPro Bulk RNA-seq", "Re-primed hPSC", "H9",</span></span>
<span>    <span class="co"># "GSM4116154", "H9 capacitated 1 Bulk RNA-seq", "Capacitated hPSC", "H9",</span></span>
<span>    <span class="co"># "GSM4116155", "H9 capacitated 2 Bulk RNA-seq", "Capacitated hPSC", "H9",</span></span>
<span>    <span class="st">"GSM4116156"</span>, <span class="st">"H9 naïve Bulk RNA-seq"</span>, <span class="st">"Naïve hPSC"</span>, <span class="st">"H9"</span>,</span>
<span>    <span class="st">"GSM4116157"</span>, <span class="st">"AN naïve Bulk RNA-seq"</span>, <span class="st">"Naïve hPSC"</span>, <span class="st">"AN"</span>,</span>
<span>    <span class="st">"GSM4116158"</span>, <span class="st">"H9 naïve TSC Bulk RNA-seq"</span>, <span class="st">"Naïve hTSC"</span>, <span class="st">"H9"</span>,</span>
<span>    <span class="st">"GSM4116159"</span>, <span class="st">"AN naïve TSC Bulk RNA-seq"</span>, <span class="st">"Naïve hTSC"</span>, <span class="st">"AN"</span>,</span>
<span>    <span class="st">"GSM4116160"</span>, <span class="st">"WIBR3 naïve TSC Bulk RNA-seq"</span>, <span class="st">"Naïve hTSC"</span>, <span class="st">"WIBR3"</span>,</span>
<span>    <span class="co"># "GSM4116161", "H9 EVT Bulk RNA-seq", "EVT", "H9",</span></span>
<span>    <span class="co"># "GSM4116162", "AN EVT Bulk RNA-seq", "EVT", "AN",</span></span>
<span>    <span class="co"># "GSM4116163", "H9 STB Bulk RNA-seq", "STB", "H9",</span></span>
<span>    <span class="co"># "GSM4116164", "AN STB Bulk RNA-seq", "STB", "AN",</span></span>
<span>    <span class="st">"GSM4276363"</span>, <span class="st">"H9 naïve TSC rep 2 Bulk RNA-seq"</span>, <span class="st">"Naïve hTSC"</span>, <span class="st">"H9"</span>,</span>
<span>    <span class="st">"GSM4276364"</span>, <span class="st">"AN naïve TSC rep 2 Bulk RNA-seq"</span>, <span class="st">"Naïve hTSC"</span>, <span class="st">"AN"</span>,</span>
<span>    <span class="co"># "GSM4276365", "BT5 hTSC rep 1 Bulk RNA-seq", "BT5 hTSCs", "BT5",</span></span>
<span>    <span class="co"># "GSM4276366", "BT5 hTSC rep 2 Bulk RNA-seq", "BT5 hTSCs", "BT5"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cell_metadata_PRJNA576801</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"raw/public/PRJNA576801"</span>,</span>
<span>        <span class="st">"SraRunTable.txt"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">","</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>        sample_name <span class="op">=</span> <span class="st">"Sample Name"</span>,</span>
<span>        run <span class="op">=</span> <span class="st">"Run"</span>,</span>
<span>        biosample <span class="op">=</span> <span class="st">"BioSample"</span>,</span>
<span>        <span class="va">source_name</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        source_name <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span></span>
<span>            string <span class="op">=</span> <span class="va">source_name</span>, pattern <span class="op">=</span> <span class="st">"\\s.+$"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        source_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">source_name</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hPSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"EVT"</span>, <span class="st">"STB"</span><span class="op">)</span>,</span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">geo_info_PRJNA576801</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cell_line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cell_line</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_PRJNA576801_pseudobulk_lineage</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA576801</span><span class="op">$</span><span class="va">group</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">cell_metadata_PRJNA576801</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">group</span> <span class="op">==</span> <span class="va">x</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">sample_name</span><span class="op">)</span></span>
<span></span>
<span>        <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA576801</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA576801</span><span class="op">$</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA576801_pseudobulk_lineage</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span></span>
<span>        string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA576801_pseudobulk_lineage</span><span class="op">)</span>,</span>
<span>        pattern <span class="op">=</span> <span class="st">" "</span>, replacement <span class="op">=</span> <span class="st">"_"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA576801</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">geo_info_PRJNA576801</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA576801</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="cinkornpumin-et-al" class="level4"><h4 class="anchored" data-anchor-id="cinkornpumin-et-al">Cinkornpumin et al</h4>
<p><a href="https://doi.org/10.1016/j.stemcr.2020.06.003">Naïve human embryonic stem cells can give rise to cells with a trophoblast-like transcriptome and methylome</a></p>
<ul>
<li>BioProject Accession: PRJNA638350</li>
<li>GEO Accession: GSE152101</li>
<li>Notebook: <a href="https://jlduan.github.io/replica/j.stemcr.2020.06.003">https://jlduan.github.io/replica/j.stemcr.2020.06.003</a>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_PRJNA638350</span> <span class="op">&lt;-</span> <span class="fu">load_matrix</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">PROJECT_DIR</span>, <span class="st">"raw/public/PRJNA638350"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_info_PRJNA638350</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">cell</span>, <span class="op">~</span><span class="va">sample_description</span>, <span class="op">~</span><span class="va">source_name2</span>, <span class="op">~</span><span class="va">group</span>, <span class="op">~</span><span class="va">cell_line</span>,</span>
<span>    <span class="st">"GSM4603117"</span>, <span class="st">"BT2 hTSC Rep1"</span>, <span class="st">"BT2 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"BT2"</span>,</span>
<span>    <span class="st">"GSM4603118"</span>, <span class="st">"BT2 hTSC Rep2"</span>, <span class="st">"BT2 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"BT2"</span>,</span>
<span>    <span class="st">"GSM4603119"</span>, <span class="st">"BT2 hTSC Rep3"</span>, <span class="st">"BT2 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"BT2"</span>,</span>
<span>    <span class="st">"GSM4603120"</span>, <span class="st">"BT2 hTSC Rep4"</span>, <span class="st">"BT2 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"BT2"</span>,</span>
<span>    <span class="st">"GSM4603121"</span>, <span class="st">"CT1 hTSCs Rep1"</span>, <span class="st">"CT1 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"CT1"</span>,</span>
<span>    <span class="st">"GSM4603122"</span>, <span class="st">"CT1 hTSCs Rep2"</span>, <span class="st">"CT1 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"CT1"</span>,</span>
<span>    <span class="st">"GSM4603123"</span>, <span class="st">"CT1 hTSCs Rep3"</span>, <span class="st">"CT1 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"CT1"</span>,</span>
<span>    <span class="st">"GSM4603124"</span>, <span class="st">"CT1 hTSCs Rep4"</span>, <span class="st">"CT1 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"CT1"</span>,</span>
<span>    <span class="st">"GSM4603125"</span>, <span class="st">"CT1 hTSCs Rep5"</span>, <span class="st">"CT1 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"CT1"</span>,</span>
<span>    <span class="st">"GSM4603126"</span>, <span class="st">"CT1 hTSCs Rep6"</span>, <span class="st">"CT1 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"CT1"</span>,</span>
<span>    <span class="st">"GSM4603127"</span>, <span class="st">"CT1 hTSCs Rep7"</span>, <span class="st">"CT1 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"CT1"</span>,</span>
<span>    <span class="st">"GSM4603128"</span>, <span class="st">"CT3 hTSCs Rep1"</span>, <span class="st">"CT3 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"CT3"</span>,</span>
<span>    <span class="st">"GSM4603129"</span>, <span class="st">"CT3 hTSCs Rep2"</span>, <span class="st">"CT3 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"CT3"</span>,</span>
<span>    <span class="st">"GSM4603130"</span>, <span class="st">"CT3 hTSCs Rep3"</span>, <span class="st">"CT3 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"CT3"</span>,</span>
<span>    <span class="st">"GSM4603131"</span>, <span class="st">"CT3 hTSCs Rep4"</span>, <span class="st">"CT3 hTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"CT3"</span>,</span>
<span>    <span class="co"># "GSM4603132", "UCLA1 Primed hESCs Rep1", "UCLA1 Primed hESC", "Primed hESC", "UCLA1",</span></span>
<span>    <span class="co"># "GSM4603133", "UCLA1 Primed hESCs Rep2", "UCLA1 Primed hESC", "Primed hESC", "UCLA1",</span></span>
<span>    <span class="co"># "GSM4603134", "UCLA1 Primed hESCs Rep3", "UCLA1 Primed hESC", "Primed hESC", "UCLA1",</span></span>
<span>    <span class="st">"GSM4603135"</span>, <span class="st">"WIBR3 Primed hESCs Rep 1"</span>, <span class="st">"WIBR3 Primed hESC"</span>, <span class="st">"Primed hESC"</span>, <span class="st">"WIBR3"</span>,</span>
<span>    <span class="st">"GSM4603136"</span>, <span class="st">"WIBR3 Primed hESCs Rep 2"</span>, <span class="st">"WIBR3 Primed hESC"</span>, <span class="st">"Primed hESC"</span>, <span class="st">"WIBR3"</span>,</span>
<span>    <span class="st">"GSM4603137"</span>, <span class="st">"WIBR3 Primed hESCs Rep 3"</span>, <span class="st">"WIBR3 Primed hESC"</span>, <span class="st">"Primed hESC"</span>, <span class="st">"WIBR3"</span>,</span>
<span>    <span class="st">"GSM4603138"</span>, <span class="st">"WIBR3 Primed hESCs Rep 4"</span>, <span class="st">"WIBR3 Primed hESC"</span>, <span class="st">"Primed hESC"</span>, <span class="st">"WIBR3"</span>,</span>
<span>    <span class="co"># "GSM4603139", "WIBR3 Naive hESCs Rep 1", "WIBR3 Naive hESC", "Primed hESC", "WIBR3",</span></span>
<span>    <span class="co"># "GSM4603140", "WIBR3 Naive hESCs Rep 2", "WIBR3 Naive hESC", "Primed hESC", "WIBR3",</span></span>
<span>    <span class="st">"GSM4603139"</span>, <span class="st">"WIBR3 Naive hESCs Rep 1"</span>, <span class="st">"WIBR3 Naive hESC"</span>, <span class="st">"Naive hESC"</span>, <span class="st">"WIBR3"</span>,</span>
<span>    <span class="st">"GSM4603140"</span>, <span class="st">"WIBR3 Naive hESCs Rep 2"</span>, <span class="st">"WIBR3 Naive hESC"</span>, <span class="st">"Naive hESC"</span>, <span class="st">"WIBR3"</span>,</span>
<span>    <span class="st">"GSM4603141"</span>, <span class="st">"WIBR3 tdhTSC Line 1 Rep 1"</span>, <span class="st">"WIBR3 tdhTSC"</span>, <span class="st">"tdhTSC"</span>, <span class="st">"WIBR3"</span>,</span>
<span>    <span class="st">"GSM4603142"</span>, <span class="st">"WIBR3 tdhTSC Line 1 Rep 2"</span>, <span class="st">"WIBR3 tdhTSC"</span>, <span class="st">"tdhTSC"</span>, <span class="st">"WIBR3"</span>,</span>
<span>    <span class="st">"GSM4603143"</span>, <span class="st">"WIBR3 tdhTSC Line 2 Rep1"</span>, <span class="st">"WIBR3 tdhTSC"</span>, <span class="st">"tdhTSC"</span>, <span class="st">"WIBR3"</span>,</span>
<span>    <span class="st">"GSM4603144"</span>, <span class="st">"WIBR3 tdhTSC Line 2 Rep 2"</span>, <span class="st">"WIBR3 tdhTSC"</span>, <span class="st">"tdhTSC"</span>, <span class="st">"WIBR3"</span>,</span>
<span>    <span class="st">"GSM4603145"</span>, <span class="st">"WIBR3 tdhTSC Line 3 Rep 1"</span>, <span class="st">"WIBR3 tdhTSC"</span>, <span class="st">"tdhTSC"</span>, <span class="st">"WIBR3"</span>,</span>
<span>    <span class="st">"GSM4603146"</span>, <span class="st">"UCLA1 tdhTSC Line 1 Rep 1"</span>, <span class="st">"UCLA1 tdhTSC"</span>, <span class="st">"tdhTSC"</span>, <span class="st">"UCLA1"</span>,</span>
<span>    <span class="st">"GSM4603147"</span>, <span class="st">"UCLA1 tdhTSC Line 1 Rep 2"</span>, <span class="st">"UCLA1 tdhTSC"</span>, <span class="st">"tdhTSC"</span>, <span class="st">"UCLA1"</span>,</span>
<span>    <span class="st">"GSM4603148"</span>, <span class="st">"FT190"</span>, <span class="st">"FT190"</span>, <span class="st">"FT190"</span>, <span class="st">"FT190"</span>,</span>
<span>    <span class="st">"GSM4603149"</span>, <span class="st">"Hec116"</span>, <span class="st">"Hec116"</span>, <span class="st">"Hec116"</span>, <span class="st">"Hec116"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cell_metadata_PRJNA638350</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"raw/public/PRJNA638350"</span>,</span>
<span>        <span class="st">"SraRunTable.txt"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">","</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"_"</span>, <span class="va">.x</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>        cell <span class="op">=</span> <span class="va">sample_name</span>,</span>
<span>        <span class="va">run</span>,</span>
<span>        <span class="va">biosample</span>,</span>
<span>        <span class="va">source_name</span>,</span>
<span>        <span class="va">cell_type</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">geo_info_PRJNA638350</span>, by <span class="op">=</span> <span class="st">"cell"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">group</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Naive hESC"</span>, <span class="st">"Primed hESC"</span>, <span class="st">"tdhTSC"</span>, <span class="st">"hTSC"</span>, <span class="st">"FT190"</span>, <span class="st">"Hec116"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_PRJNA638350_pseudobulk_lineage</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA638350</span><span class="op">$</span><span class="va">group</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">cell_metadata_PRJNA638350</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">group</span> <span class="op">==</span> <span class="va">x</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cells_in_group</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA638350</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">m</span> <span class="op">&lt;-</span> <span class="va">matrix_readcount_PRJNA638350</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA638350</span><span class="op">$</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA638350_pseudobulk_lineage</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA638350_pseudobulk_lineage</span><span class="op">)</span>,</span>
<span>        pattern <span class="op">=</span> <span class="st">" "</span>, replacement <span class="op">=</span> <span class="st">"_"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># clean up</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA638350</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">geo_info_PRJNA638350</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA638350</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="lv-et-al" class="level4"><h4 class="anchored" data-anchor-id="lv-et-al">Lv et al</h4>
<p><a href="https://doi.org/10.1371/journal.pbio.3000187">Single-cell RNA sequencing reveals regulatory mechanism for trophoblast cell-fate divergence in human peri-implantation conceptuses</a></p>
<ul>
<li>BioProject Accession: PRJNA516921</li>
<li>GEO Accession: GSE125616</li>
<li>Notebook: <a href="https://jlduan.github.io/replica/journal.pbio.3000187/">https://jlduan.github.io/replica/journal.pbio.3000187</a>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_PRJNA516921</span> <span class="op">&lt;-</span> <span class="fu">load_matrix</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">PROJECT_DIR</span>, <span class="st">"raw/public/PRJNA516921"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_info_PRJNA516921</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"raw/public/PRJNA516921"</span>,</span>
<span>        <span class="st">"notebooks"</span>,</span>
<span>        <span class="st">"sample.csv"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">","</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cell_metadata_PRJNA516921</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"raw/public/PRJNA516921"</span>,</span>
<span>        <span class="st">"SraRunTable.txt"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">","</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"_"</span>, <span class="va">.x</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>        cell <span class="op">=</span> <span class="va">sample_name</span>,</span>
<span>        <span class="va">run</span>,</span>
<span>        <span class="va">biosample</span>,</span>
<span>        <span class="va">development_day</span>,</span>
<span>        <span class="va">source_name</span>,</span>
<span>        <span class="va">stage</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span></span>
<span>        <span class="va">geo_info_PRJNA516921</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Accession</span>, <span class="va">Title</span><span class="op">)</span>,</span>
<span>        by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cell"</span> <span class="op">=</span> <span class="st">"Accession"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select_all.html">rename_all</a></span><span class="op">(</span><span class="va">tolower</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span></span>
<span>        developmental_stage <span class="op">=</span> <span class="st">"development_day"</span>,</span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        developmental_stage <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span></span>
<span>            string <span class="op">=</span> <span class="va">developmental_stage</span>,</span>
<span>            pattern <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>            replacement <span class="op">=</span> <span class="st">"Day "</span></span>
<span>        <span class="op">)</span>,</span>
<span>        developmental_stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">developmental_stage</span>,</span>
<span>            levels <span class="op">=</span> <span class="va">developmental_stage</span> <span class="op">|&gt;</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_order.html">str_sort</a></span><span class="op">(</span>numeric <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        stage <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_title</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">stage</span><span class="op">)</span>,</span>
<span>        stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">stage</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="st">"Blastocyst"</span>, <span class="st">"Implantation"</span>,</span>
<span>                <span class="st">"Post-Implantation"</span>, <span class="st">"Endometrial"</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">cell_metadata_PRJNA516921</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"raw/public/PRJNA516921"</span>,</span>
<span>        <span class="st">"exploring/embedding_ncomponents14_seed20200317.csv"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span></span>
<span>        <span class="va">cell_metadata_PRJNA516921</span>,</span>
<span>        by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cell"</span> <span class="op">=</span> <span class="st">"cell"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>        <span class="va">cell</span><span class="op">:</span><span class="va">y_umap</span>, <span class="va">run</span><span class="op">:</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>        <span class="op">!</span><span class="op">(</span></span>
<span>            <span class="va">louvain</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">|</span> <span class="op">(</span></span>
<span>                <span class="va">developmental_stage</span> <span class="op">==</span> <span class="st">"Day 6"</span> <span class="op">&amp;</span> <span class="va">louvain</span> <span class="op">==</span> <span class="fl">1</span></span>
<span>            <span class="op">)</span> <span class="op">|</span> <span class="op">(</span></span>
<span>                <span class="va">developmental_stage</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Day 13"</span>, <span class="st">"Day 14"</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        lineage <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>            <span class="va">cell</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="st">"GSM3578305"</span>,</span>
<span>                <span class="st">"GSM3578308"</span>,</span>
<span>                <span class="st">"GSM3578339"</span>,</span>
<span>                <span class="st">"GSM3578505"</span>,</span>
<span>                <span class="st">"GSM3578651"</span>,</span>
<span>                <span class="st">"GSM3578653"</span>,</span>
<span>                <span class="st">"GSM3578682"</span>,</span>
<span>                <span class="st">"GSM3578696"</span>,</span>
<span>                <span class="st">"GSM3578697"</span>,</span>
<span>                <span class="st">"GSM3578707"</span>,</span>
<span>                <span class="st">"GSM3578729"</span></span>
<span>            <span class="op">)</span> <span class="op">~</span> <span class="st">"PE"</span>,</span>
<span>            <span class="va">cell</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="st">"GSM3578300"</span>,</span>
<span>                <span class="st">"GSM3578302"</span>,</span>
<span>                <span class="st">"GSM3578365"</span>,</span>
<span>                <span class="st">"GSM3578492"</span>,</span>
<span>                <span class="st">"GSM3578515"</span>,</span>
<span>                <span class="st">"GSM3578666"</span>,</span>
<span>                <span class="st">"GSM3578668"</span>,</span>
<span>                <span class="st">"GSM3578714"</span>,</span>
<span>                <span class="st">"GSM3578716"</span>,</span>
<span>                <span class="st">"GSM3578728"</span></span>
<span>            <span class="op">)</span> <span class="op">~</span> <span class="st">"EPI"</span>,</span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"TE"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        lineage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">lineage</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"EPI"</span>, <span class="st">"PE"</span>, <span class="st">"TE"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_PRJNA516921_pseudobulk_TE</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA516921</span><span class="op">$</span><span class="va">developmental_stage</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">cell_metadata_PRJNA516921</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">lineage</span> <span class="op">==</span> <span class="st">"TE"</span>,</span>
<span>                <span class="va">developmental_stage</span> <span class="op">==</span> <span class="va">x</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cells_in_group</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA516921</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">m</span> <span class="op">&lt;-</span> <span class="va">matrix_readcount_PRJNA516921</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="va">cell_metadata_PRJNA516921</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">lineage</span> <span class="op">==</span> <span class="st">"TE"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">developmental_stage</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA516921</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">geo_info_PRJNA516921</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA516921</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="linneberg-agerholm-et-al" class="level4"><h4 class="anchored" data-anchor-id="linneberg-agerholm-et-al">Linneberg-Agerholm et al</h4>
<p><a href="https://doi.org/10.1242/dev.180620">Naïve human pluripotent stem cells respond to Wnt, Nodal and LIF signalling to produce expandable naïve extra-embryonic endoderm</a></p>
<ul>
<li>BioProject Accession: PRJNA574150</li>
<li>GEO Accession: GSE138012</li>
<li>Notebook: <a href="https://jlduan.github.io/replica/dev.180620">https://jlduan.github.io/replica/dev.180620</a>
</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_PRJNA574150</span> <span class="op">&lt;-</span> <span class="fu">load_matrix</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">PROJECT_DIR</span>, <span class="st">"raw/public/PRJNA574150"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">geo_info_PRJNA574150</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">cell</span>, <span class="op">~</span><span class="va">sample_description</span>,</span>
<span>    <span class="st">"GSM4096610"</span>, <span class="st">"H9_pES_R1"</span>,</span>
<span>    <span class="st">"GSM4096611"</span>, <span class="st">"H9_pES_R2"</span>,</span>
<span>    <span class="st">"GSM4096612"</span>, <span class="st">"H9_t2iLGo_nES_R2"</span>,</span>
<span>    <span class="st">"GSM4096613"</span>, <span class="st">"H9_t2iLGo_nES_R1"</span>,</span>
<span>    <span class="st">"GSM4096614"</span>, <span class="st">"H9_t2iLGo_nES_R3"</span>,</span>
<span>    <span class="st">"GSM4096615"</span>, <span class="st">"H9_h2iL_nES_R1"</span>,</span>
<span>    <span class="st">"GSM4096616"</span>, <span class="st">"H9_h2iL_nES_R2"</span>,</span>
<span>    <span class="st">"GSM4096617"</span>, <span class="st">"H9_h2iL_nES_R3"</span>,</span>
<span>    <span class="st">"GSM4096618"</span>, <span class="st">"H9_t2iLGo_PrE_R2"</span>,</span>
<span>    <span class="st">"GSM4096619"</span>, <span class="st">"H9_t2iLGo_PrE_R3"</span>,</span>
<span>    <span class="st">"GSM4096620"</span>, <span class="st">"H9_t2iLGo_PrE_R1"</span>,</span>
<span>    <span class="st">"GSM4096621"</span>, <span class="st">"H9_h2iL_PrE_R2"</span>,</span>
<span>    <span class="st">"GSM4096622"</span>, <span class="st">"H9_h2iL_PrE_R3"</span>,</span>
<span>    <span class="st">"GSM4096623"</span>, <span class="st">"H9_h2iL_PrE_R1"</span>,</span>
<span>    <span class="st">"GSM4096624"</span>, <span class="st">"HUES4_pES_R1"</span>,</span>
<span>    <span class="st">"GSM4096625"</span>, <span class="st">"HUES4_pES_R2"</span>,</span>
<span>    <span class="st">"GSM4096626"</span>, <span class="st">"H9_ADE_R1"</span>,</span>
<span>    <span class="st">"GSM4096627"</span>, <span class="st">"H9_ADE_R2"</span>,</span>
<span>    <span class="st">"GSM4096628"</span>, <span class="st">"HUES4_ADE_R2"</span>,</span>
<span>    <span class="st">"GSM4096629"</span>, <span class="st">"HUES4_ADE_R1"</span>,</span>
<span>    <span class="st">"GSM4096630"</span>, <span class="st">"H9_RSeT_nES_R1"</span>,</span>
<span>    <span class="st">"GSM4096631"</span>, <span class="st">"H9_RSeT_nES_R2"</span>,</span>
<span>    <span class="st">"GSM4096632"</span>, <span class="st">"H9_t2iLGo_nEnd_R1"</span>,</span>
<span>    <span class="st">"GSM4096633"</span>, <span class="st">"H9_t2iLGo_nEnd_R2"</span>,</span>
<span>    <span class="st">"GSM4096634"</span>, <span class="st">"H9_t2iLGo_nEnd_R3"</span>,</span>
<span>    <span class="st">"GSM4096635"</span>, <span class="st">"H9_RSeT_PrE_R1-1"</span>,</span>
<span>    <span class="st">"GSM4096636"</span>, <span class="st">"H9_RSeT_PrE_R2-1"</span>,</span>
<span>    <span class="st">"GSM4096637"</span>, <span class="st">"H9_DE_R1"</span>,</span>
<span>    <span class="st">"GSM4096638"</span>, <span class="st">"H9_DE_R2"</span>,</span>
<span>    <span class="st">"GSM4096639"</span>, <span class="st">"H9_DE_R3"</span>,</span>
<span>    <span class="st">"GSM4096640"</span>, <span class="st">"H9_RSeT_PrE_R1-2"</span>,</span>
<span>    <span class="st">"GSM4096641"</span>, <span class="st">"H9_RSeT_PrE_R2-2"</span>,</span>
<span>    <span class="st">"GSM4096642"</span>, <span class="st">"H9_RSeT_nEnd_R1"</span>,</span>
<span>    <span class="st">"GSM4096643"</span>, <span class="st">"H9_RSeT_nEnd_R2"</span>,</span>
<span>    <span class="st">"GSM4096644"</span>, <span class="st">"H9_RSeT_nEnd_R3"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cell_metadata_PRJNA574150</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"raw/public/PRJNA574150"</span>,</span>
<span>        <span class="st">"SraRunTable.txt"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">","</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"_"</span>, <span class="va">.x</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>        cell <span class="op">=</span> <span class="va">sample_name</span>,</span>
<span>        <span class="va">run</span>,</span>
<span>        <span class="va">biosample</span>,</span>
<span>        <span class="va">cell_type</span>,</span>
<span>        <span class="va">background</span>,</span>
<span>        <span class="va">source_name</span>,</span>
<span>        <span class="va">stage</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">geo_info_PRJNA574150</span>, by <span class="op">=</span> <span class="st">"cell"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        group <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span></span>
<span>            string <span class="op">=</span> <span class="va">sample_description</span>,</span>
<span>            pattern <span class="op">=</span> <span class="st">"_R\\d.*$"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        lineage <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span></span>
<span>            string <span class="op">=</span> <span class="va">group</span>, pattern <span class="op">=</span> <span class="st">".+_"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        lineage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">lineage</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"nES"</span>, <span class="st">"pES"</span>, <span class="st">"PrE"</span>, <span class="st">"nEnd"</span>, <span class="st">"DE"</span>, <span class="st">"ADE"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>cell_line <span class="op">=</span> <span class="st">"background"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_PRJNA574150_pseudobulk_lineage</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA574150</span><span class="op">$</span><span class="va">lineage</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">cell_metadata_PRJNA574150</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">lineage</span> <span class="op">==</span> <span class="va">x</span>,</span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cells_in_group</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA574150</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">m</span> <span class="op">&lt;-</span> <span class="va">matrix_readcount_PRJNA574150</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA574150</span><span class="op">$</span><span class="va">lineage</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA574150</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">geo_info_PRJNA574150</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">cell_metadata_PRJNA574150</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="principal-component-analysis" class="level3"><h3 class="anchored" data-anchor-id="principal-component-analysis">Principal component analysis</h3>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">features_hg_cy</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"github"</span>,</span>
<span>        <span class="st">"data"</span>,</span>
<span>        <span class="st">"features_hg_cy.csv.gz"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># prepare features</span></span>
<span><span class="va">table_s3_sheet1</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>    path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"docs"</span>,</span>
<span>        <span class="st">"Reconstituting_the_transcriptome_and_DNA_methylome_landscapes_of_human_implantation"</span>,</span>
<span>        <span class="st">"41586_2019_1500_MOESM3_ESM"</span>,</span>
<span>        <span class="st">"Supplementary Table 3 Lineage_Markers.xlsx"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    sheet <span class="op">=</span> <span class="st">"Sheet1"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">table_s3_sheet1</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;">gene</th>
<th style="text-align: right;">myAUC</th>
<th style="text-align: right;">avg_diff</th>
<th style="text-align: right;">power</th>
<th style="text-align: right;">pct.1</th>
<th style="text-align: right;">pct.2</th>
<th style="text-align: left;">cluster</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DPPA5</td>
<td style="text-align: right;">0.987</td>
<td style="text-align: right;">4.287821</td>
<td style="text-align: right;">0.974</td>
<td style="text-align: right;">0.985</td>
<td style="text-align: right;">0.247</td>
<td style="text-align: left;">EPI</td>
</tr>
<tr class="even">
<td style="text-align: left;">IFITM1</td>
<td style="text-align: right;">0.987</td>
<td style="text-align: right;">3.334143</td>
<td style="text-align: right;">0.974</td>
<td style="text-align: right;">0.997</td>
<td style="text-align: right;">0.593</td>
<td style="text-align: left;">EPI</td>
</tr>
<tr class="odd">
<td style="text-align: left;">POU5F1</td>
<td style="text-align: right;">0.986</td>
<td style="text-align: right;">3.814455</td>
<td style="text-align: right;">0.972</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">0.355</td>
<td style="text-align: left;">EPI</td>
</tr>
<tr class="even">
<td style="text-align: left;">KHDC3L</td>
<td style="text-align: right;">0.970</td>
<td style="text-align: right;">4.646703</td>
<td style="text-align: right;">0.940</td>
<td style="text-align: right;">0.958</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: left;">EPI</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TDGF1</td>
<td style="text-align: right;">0.970</td>
<td style="text-align: right;">3.947136</td>
<td style="text-align: right;">0.940</td>
<td style="text-align: right;">0.958</td>
<td style="text-align: right;">0.202</td>
<td style="text-align: left;">EPI</td>
</tr>
<tr class="even">
<td style="text-align: left;">ESRG</td>
<td style="text-align: right;">0.964</td>
<td style="text-align: right;">3.447912</td>
<td style="text-align: right;">0.928</td>
<td style="text-align: right;">0.961</td>
<td style="text-align: right;">0.393</td>
<td style="text-align: left;">EPI</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">features_hg_EPI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span><span class="op">[</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span></span>
<span>        string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span>,</span>
<span>        pattern <span class="op">=</span> <span class="st">"^E.+_"</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="op">(</span><span class="va">table_s3_sheet1</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>            <span class="va">cluster</span> <span class="op">==</span> <span class="st">"EPI"</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">features_hg_cy_EPI_hg</span> <span class="op">&lt;-</span> <span class="va">features_hg_cy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hg</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">features_hg_EPI</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">hg</span><span class="op">)</span></span>
<span></span>
<span><span class="va">features_hg_cy_EPI_cy</span> <span class="op">&lt;-</span> <span class="va">features_hg_cy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hg</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">features_hg_EPI</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cy</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">features_hg_TE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span><span class="op">[</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span></span>
<span>        string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span>,</span>
<span>        pattern <span class="op">=</span> <span class="st">"^E.+_"</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="op">(</span><span class="va">table_s3_sheet1</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>            <span class="va">cluster</span> <span class="op">==</span> <span class="st">"TE"</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">features_hg_cy_TE_hg</span> <span class="op">&lt;-</span> <span class="va">features_hg_cy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hg</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">features_hg_TE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">hg</span><span class="op">)</span></span>
<span></span>
<span><span class="va">features_hg_cy_TE_cy</span> <span class="op">&lt;-</span> <span class="va">features_hg_cy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hg</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">features_hg_TE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cy</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">features_hg_HYP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span><span class="op">[</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span></span>
<span>        string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span>,</span>
<span>        pattern <span class="op">=</span> <span class="st">"^E.+_"</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="op">(</span><span class="va">table_s3_sheet1</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>            <span class="va">cluster</span> <span class="op">==</span> <span class="st">"PE"</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">features_hg_cy_HYP_hg</span> <span class="op">&lt;-</span> <span class="va">features_hg_cy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hg</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">features_hg_HYP</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">hg</span><span class="op">)</span></span>
<span></span>
<span><span class="va">features_hg_cy_HYP_cy</span> <span class="op">&lt;-</span> <span class="va">features_hg_cy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">hg</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">features_hg_HYP</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cy</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="epi" class="level4"><h4 class="anchored" data-anchor-id="epi">EPI</h4>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># z-score</span></span>
<span><span class="va">clusters_selected_blastoid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"11"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>    <span class="va">matrix_readcount_blastoid_pseudobulk</span><span class="op">[</span>, <span class="va">clusters_selected_blastoid</span><span class="op">]</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="va">matrix_readcount_stem_pseudobulk</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LW50"</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="va">matrix_readcount_PRJEB11202_pseudobulk_EPI</span>,</span>
<span>    <span class="va">matrix_readcount_PRJNA562548_pseudobulk_EPI</span>,</span>
<span>    <span class="va">matrix_readcount_PRJNA431392_pseudobulk_EPI</span>,</span>
<span>    <span class="va">matrix_readcount_PRJEB7132_pseudobulk</span>,</span>
<span>    <span class="va">matrix_readcount_PRJNA576801_pseudobulk_lineage</span><span class="op">[</span></span>
<span>        , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Naïve_hPSC"</span>, <span class="st">"Primed_hPSC"</span><span class="op">)</span></span>
<span>    <span class="op">]</span>,</span>
<span>    <span class="va">matrix_readcount_PRJNA638350_pseudobulk_lineage</span><span class="op">[</span></span>
<span>        , <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Naive_hESC"</span>, <span class="st">"Primed_hESC"</span><span class="op">)</span></span>
<span>    <span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_pca</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="st">"Blastoid"</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="st">"Blastoid"</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="st">"PRJEB11202"</span>,</span>
<span>            <span class="st">"PRJNA562548"</span>,</span>
<span>            <span class="st">"PRJNA431392"</span>,</span>
<span>            <span class="st">"PRJEB7132"</span>,</span>
<span>            <span class="st">"PRJNA576801"</span>,</span>
<span>            <span class="st">"PRJNA638350"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">clusters_selected_blastoid</span><span class="op">)</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_stem_pseudobulk</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LW50"</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJEB11202_pseudobulk_EPI</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA562548_pseudobulk_EPI</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA431392_pseudobulk_EPI</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJEB7132_pseudobulk</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Naïve_hPSC"</span>, <span class="st">"Primed_hPSC"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Naive_hESC"</span>, <span class="st">"Primed_hESC"</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_pca</span><span class="op">)</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">":"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca_out_EPI</span> <span class="op">&lt;-</span> <span class="fu">perform_pca</span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">matrix_readcount_pca</span>,</span>
<span>    features <span class="op">=</span> <span class="va">features_hg_cy_EPI_hg</span>,</span>
<span>    min_counts <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">embedding_pca_EPI</span> <span class="op">&lt;-</span> <span class="va">pca_out_EPI</span><span class="op">$</span><span class="va">x</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"sample_name"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sample_name</span><span class="op">:</span><span class="va">PC3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span></span>
<span>        x_pca <span class="op">=</span> <span class="va">PC1</span>,</span>
<span>        y_pca <span class="op">=</span> <span class="va">PC2</span>,</span>
<span>        z_pca <span class="op">=</span> <span class="va">PC3</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">x_pca</span>, <span class="va">y_pca</span>, <span class="va">z_pca</span>, .after <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        lineage <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">sample_name</span>, pattern <span class="op">=</span> <span class="st">"^P.+:"</span><span class="op">)</span>,</span>
<span>        dataset <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">sample_name</span>, pattern <span class="op">=</span> <span class="st">":.+$"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
</section><section id="te" class="level4"><h4 class="anchored" data-anchor-id="te">TE</h4>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clusters_selected_blastoid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"8"</span>, <span class="st">"9"</span>, <span class="st">"12"</span>, <span class="st">"17"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>    <span class="va">matrix_readcount_blastoid_pseudobulk</span><span class="op">[</span>, <span class="va">clusters_selected_blastoid</span><span class="op">]</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="va">matrix_readcount_stem_pseudobulk</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LW52"</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="va">matrix_readcount_PRJEB11202_pseudobulk_TE</span>,</span>
<span>    <span class="va">matrix_readcount_PRJNA431392_pseudobulk_TE</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="va">matrix_readcount_PRJNA576801_pseudobulk_lineage</span>,</span>
<span>    <span class="va">matrix_readcount_PRJNA638350_pseudobulk_lineage</span><span class="op">[</span></span>
<span>        ,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Naive_hESC"</span>, <span class="st">"Primed_hESC"</span>, <span class="st">"tdhTSC"</span>, <span class="st">"hTSC"</span><span class="op">)</span></span>
<span>    <span class="op">]</span>,</span>
<span>    <span class="va">matrix_readcount_PRJNA516921_pseudobulk_TE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># name columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_pca</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="st">"Blastoid"</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="st">"Blastoid"</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="st">"PRJEB11202"</span>,</span>
<span>            <span class="st">"PRJNA431392"</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="st">"PRJNA576801"</span>,</span>
<span>            <span class="st">"PRJNA638350"</span>,</span>
<span>            <span class="st">"PRJNA516921"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_blastoid_pseudobulk</span><span class="op">[</span></span>
<span>                ,</span>
<span>                <span class="va">clusters_selected_blastoid</span></span>
<span>            <span class="op">]</span><span class="op">)</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_stem_pseudobulk</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LW52"</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJEB11202_pseudobulk_TE</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA431392_pseudobulk_TE</span><span class="op">)</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA576801_pseudobulk_lineage</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Naive_hESC"</span>, <span class="st">"Primed_hESC"</span>, <span class="st">"tdhTSC"</span>, <span class="st">"hTSC"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA516921_pseudobulk_TE</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_pca</span><span class="op">)</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">":"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_pca</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span></span>
<span>    string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_pca</span><span class="op">)</span>,</span>
<span>    pattern <span class="op">=</span> <span class="st">" "</span>,</span>
<span>    replacement <span class="op">=</span> <span class="st">"_"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_pca</span> <span class="op">&lt;-</span> <span class="va">matrix_readcount_pca</span><span class="op">[</span></span>
<span>    , <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_pca</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"Blastoid:0"</span>,</span>
<span>        <span class="st">"Blastoid:1"</span>,</span>
<span>        <span class="st">"Blastoid:8"</span>,</span>
<span>        <span class="st">"Blastoid:9"</span>,</span>
<span>        <span class="st">"Blastoid:12"</span>,</span>
<span>        <span class="st">"Blastoid:17"</span>,</span>
<span>        <span class="st">"Blastoid:LW52"</span>,</span>
<span>        <span class="st">"PRJEB11202:E5"</span>,</span>
<span>        <span class="st">"PRJEB11202:E6"</span>,</span>
<span>        <span class="st">"PRJEB11202:E7"</span>,</span>
<span>        <span class="st">"PRJNA431392:E6"</span>,</span>
<span>        <span class="st">"PRJNA431392:E8"</span>,</span>
<span>        <span class="st">"PRJNA431392:E10"</span>,</span>
<span>        <span class="st">"PRJNA431392:E12"</span>,</span>
<span>        <span class="st">"PRJNA576801:Naïve_hTSC"</span>,</span>
<span>        <span class="st">"PRJNA638350:tdhTSC"</span>,</span>
<span>        <span class="st">"PRJNA638350:hTSC"</span>,</span>
<span>        <span class="st">"PRJNA516921:Day_6"</span>,</span>
<span>        <span class="st">"PRJNA516921:Day_7"</span>,</span>
<span>        <span class="st">"PRJNA516921:Day_8"</span>,</span>
<span>        <span class="st">"PRJNA516921:Day_9"</span>,</span>
<span>        <span class="st">"PRJNA516921:Day_10"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca_out_TE</span> <span class="op">&lt;-</span> <span class="fu">perform_pca</span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">matrix_readcount_pca</span>,</span>
<span>    features <span class="op">=</span> <span class="va">features_hg_cy_TE_hg</span>,</span>
<span>    min_counts <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">embedding_pca_TE</span> <span class="op">&lt;-</span> <span class="va">pca_out_TE</span><span class="op">$</span><span class="va">x</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"sample_name"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sample_name</span><span class="op">:</span><span class="va">PC3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span></span>
<span>        x_pca <span class="op">=</span> <span class="va">PC1</span>,</span>
<span>        y_pca <span class="op">=</span> <span class="va">PC2</span>,</span>
<span>        z_pca <span class="op">=</span> <span class="va">PC3</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">x_pca</span>, <span class="va">y_pca</span>, <span class="va">z_pca</span>, .after <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        lineage <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">sample_name</span>, pattern <span class="op">=</span> <span class="st">"^P.+:"</span><span class="op">)</span>,</span>
<span>        dataset <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">sample_name</span>, pattern <span class="op">=</span> <span class="st">":.+$"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="hyp" class="level4"><h4 class="anchored" data-anchor-id="hyp">HYP</h4>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clusters_selected_blastoid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"18"</span>, <span class="st">"15"</span>, <span class="st">"16"</span>, <span class="st">"13"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>    <span class="va">matrix_readcount_blastoid_pseudobulk</span><span class="op">[</span></span>
<span>        ,</span>
<span>        <span class="va">clusters_selected_blastoid</span>,</span>
<span>        drop <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">]</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="va">matrix_readcount_stem_pseudobulk</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LW51"</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="va">matrix_readcount_PRJEB11202_pseudobulk_HYP</span>,</span>
<span>    <span class="va">matrix_readcount_PRJNA562548_pseudobulk_HYP</span>,</span>
<span>    <span class="va">matrix_readcount_PRJNA431392_pseudobulk_HYP</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="va">matrix_readcount_PRJNA574150_pseudobulk_lineage</span><span class="op">[</span>, <span class="st">"nEnd"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># name columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_pca</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="st">"Blastoid"</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="st">"Blastoid"</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="st">"PRJEB11202"</span>,</span>
<span>            <span class="st">"PRJNA562548"</span>,</span>
<span>            <span class="st">"PRJNA431392"</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="st">"PRJNA574150"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">clusters_selected_blastoid</span><span class="op">)</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_stem_pseudobulk</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LW51"</span><span class="op">)</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJEB11202_pseudobulk_HYP</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA562548_pseudobulk_HYP</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA431392_pseudobulk_HYP</span><span class="op">)</span>,</span>
<span>            <span class="co">#</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="st">"nEnd"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_pca</span><span class="op">)</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">":"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_pca</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span></span>
<span>    string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_pca</span><span class="op">)</span>,</span>
<span>    pattern <span class="op">=</span> <span class="st">" "</span>,</span>
<span>    replacement <span class="op">=</span> <span class="st">"_"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca_out_HYP</span> <span class="op">&lt;-</span> <span class="fu">perform_pca</span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">matrix_readcount_pca</span>,</span>
<span>    features <span class="op">=</span> <span class="va">features_hg_cy_HYP_hg</span>,</span>
<span>    min_counts <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">embedding_pca_HYP</span> <span class="op">&lt;-</span> <span class="va">pca_out_HYP</span><span class="op">$</span><span class="va">x</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"sample_name"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sample_name</span><span class="op">:</span><span class="va">PC3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span></span>
<span>        x_pca <span class="op">=</span> <span class="va">PC1</span>,</span>
<span>        y_pca <span class="op">=</span> <span class="va">PC2</span>,</span>
<span>        z_pca <span class="op">=</span> <span class="va">PC3</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">x_pca</span>, <span class="va">y_pca</span>, <span class="va">z_pca</span>, .after <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        lineage <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">sample_name</span>, pattern <span class="op">=</span> <span class="st">"^P.+:"</span><span class="op">)</span>,</span>
<span>        dataset <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">sample_name</span>, pattern <span class="op">=</span> <span class="st">":.+$"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="visualization-joint" class="level4"><h4 class="anchored" data-anchor-id="visualization-joint">Visualization, joint</h4>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># assign colors</span></span>
<span></span>
<span><span class="va">studies</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">bioproject</span>, <span class="op">~</span><span class="va">description</span>,</span>
<span>    <span class="st">"Blastoid"</span>, <span class="st">"Blastoid"</span>,</span>
<span>    <span class="st">"PRJEB11202"</span>, <span class="st">"Petropoulos et al., 2016"</span>,</span>
<span>    <span class="st">"PRJEB7132"</span>, <span class="st">"Takashima et al., 2014"</span>,</span>
<span>    <span class="st">"PRJNA431392"</span>, <span class="st">"Zhou et al., 2019"</span>,</span>
<span>    <span class="st">"PRJNA516921"</span>, <span class="st">"lv et al., 2019"</span>,</span>
<span>    <span class="st">"PRJNA562548"</span>, <span class="st">"Xiang et al., 2020"</span>,</span>
<span>    <span class="st">"PRJNA574150"</span>, <span class="st">"Linneberg-Agerholm et al., 2019"</span>,</span>
<span>    <span class="st">"PRJNA576801"</span>, <span class="st">"Dong et al., 2020"</span>,</span>
<span>    <span class="st">"PRJNA638350"</span>, <span class="st">"Cinkornpumin et al., 2020"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="st">"#F8766D"</span>,</span>
<span>            <span class="st">"#D39200"</span>,</span>
<span>            <span class="st">"#93AA00"</span>,</span>
<span>            <span class="st">"#00BA38"</span>,</span>
<span>            <span class="st">"#00C19F"</span>,</span>
<span>            <span class="st">"#00B9E3"</span>,</span>
<span>            <span class="st">"#619CFF"</span>,</span>
<span>            <span class="st">"#DB72FB"</span>,</span>
<span>            <span class="st">"#FF61C3"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">embedding_pca_EPI</span> <span class="op">&lt;-</span> <span class="va">embedding_pca_EPI</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dataset</span>, levels <span class="op">=</span> <span class="va">studies</span><span class="op">$</span><span class="va">bioproject</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">embedding_pca_HYP</span> <span class="op">&lt;-</span> <span class="va">embedding_pca_HYP</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        y_pca <span class="op">=</span> <span class="fl">0</span> <span class="op">-</span> <span class="va">y_pca</span>,</span>
<span>        dataset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dataset</span>, levels <span class="op">=</span> <span class="va">studies</span><span class="op">$</span><span class="va">bioproject</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">embedding_pca_TE</span> <span class="op">&lt;-</span> <span class="va">embedding_pca_TE</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        dataset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dataset</span>, levels <span class="op">=</span> <span class="va">studies</span><span class="op">$</span><span class="va">bioproject</span><span class="op">)</span>,</span>
<span>        lineage <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span></span>
<span>            string <span class="op">=</span> <span class="va">lineage</span>, pattern <span class="op">=</span> <span class="st">"Day_"</span>, replacement <span class="op">=</span> <span class="st">"E"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compose</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">plot_pca_embedding</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">embedding_pca_EPI</span>,</span>
<span>    x <span class="op">=</span> <span class="va">x_pca</span>,</span>
<span>    y <span class="op">=</span> <span class="va">y_pca</span>,</span>
<span>    color <span class="op">=</span> <span class="va">dataset</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"EPI; PCA"</span>,</span>
<span>    legend_x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    legend_y <span class="op">=</span> <span class="fl">0.995</span>,</span>
<span>    min_segment_length <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">add_xy_label_pca</span><span class="op">(</span><span class="va">pca_out_EPI</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>        values <span class="op">=</span> <span class="va">studies</span><span class="op">$</span><span class="va">color</span>,</span>
<span>        breaks <span class="op">=</span> <span class="va">studies</span><span class="op">$</span><span class="va">bioproject</span>,</span>
<span>        labels <span class="op">=</span> <span class="va">studies</span><span class="op">$</span><span class="va">description</span>,</span>
<span>        drop <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>        colour <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span></span>
<span>            override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">ab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span></span>
<span>    <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/rlm.html">rlm</a></span><span class="op">(</span><span class="va">y_pca</span> <span class="op">~</span> <span class="va">x_pca</span>,</span>
<span>        data <span class="op">=</span> <span class="va">embedding_pca_EPI</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dataset</span> <span class="op">!=</span> <span class="st">"Blastoid"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span></span>
<span>    intercept <span class="op">=</span> <span class="va">ab</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, slope <span class="op">=</span> <span class="va">ab</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"#8ace7e"</span>, size <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. Please use
`linewidth` instead.
ℹ The deprecated feature was likely used in the ggplot2 package.
  Please report the issue at &lt;https://github.com/tidyverse/ggplot2/issues&gt;.</code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">plot_pca_embedding</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">embedding_pca_HYP</span>,</span>
<span>    x <span class="op">=</span> <span class="va">y_pca</span>,</span>
<span>    y <span class="op">=</span> <span class="va">x_pca</span>,</span>
<span>    color <span class="op">=</span> <span class="va">dataset</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"HYP; PCA"</span>,</span>
<span>    legend_x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    legend_y <span class="op">=</span> <span class="fl">0.995</span>,</span>
<span>    min_segment_length <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">add_xy_label_pca</span><span class="op">(</span><span class="va">pca_out_HYP</span>, <span class="st">"PC2"</span>, <span class="st">"PC1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>        values <span class="op">=</span> <span class="va">studies</span><span class="op">$</span><span class="va">color</span>,</span>
<span>        breaks <span class="op">=</span> <span class="va">studies</span><span class="op">$</span><span class="va">bioproject</span>,</span>
<span>        labels <span class="op">=</span> <span class="va">studies</span><span class="op">$</span><span class="va">description</span>,</span>
<span>        drop <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>        colour <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span></span>
<span>            override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">ab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span></span>
<span>    <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/rlm.html">rlm</a></span><span class="op">(</span><span class="va">x_pca</span> <span class="op">~</span> <span class="va">y_pca</span>,</span>
<span>        data <span class="op">=</span> <span class="va">embedding_pca_HYP</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dataset</span> <span class="op">!=</span> <span class="st">"Blastoid"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span></span>
<span>    intercept <span class="op">=</span> <span class="va">ab</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, slope <span class="op">=</span> <span class="va">ab</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"#ff684c"</span>, linewidth <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">plot_pca_embedding</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">embedding_pca_TE</span>,</span>
<span>    x <span class="op">=</span> <span class="va">x_pca</span>,</span>
<span>    y <span class="op">=</span> <span class="va">y_pca</span>,</span>
<span>    color <span class="op">=</span> <span class="va">dataset</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"TE; PCA"</span>,</span>
<span>    legend_x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    legend_y <span class="op">=</span> <span class="fl">0.995</span>,</span>
<span>    min_segment_length <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">add_xy_label_pca</span><span class="op">(</span><span class="va">pca_out_TE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>        values <span class="op">=</span> <span class="va">studies</span><span class="op">$</span><span class="va">color</span>,</span>
<span>        breaks <span class="op">=</span> <span class="va">studies</span><span class="op">$</span><span class="va">bioproject</span>,</span>
<span>        labels <span class="op">=</span> <span class="va">studies</span><span class="op">$</span><span class="va">description</span>,</span>
<span>        drop <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>        colour <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span></span>
<span>            override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">ab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span></span>
<span>    <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/rlm.html">rlm</a></span><span class="op">(</span><span class="va">y_pca</span> <span class="op">~</span> <span class="va">x_pca</span>,</span>
<span>        data <span class="op">=</span> <span class="va">embedding_pca_TE</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dataset</span> <span class="op">!=</span> <span class="st">"Blastoid"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span></span>
<span>    intercept <span class="op">=</span> <span class="va">ab</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, slope <span class="op">=</span> <span class="va">ab</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"#9467bd"</span>, size <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">`+`</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span>, guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>theme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.direction <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="compare_blastoids_files/figure-html/unnamed-chunk-54-1.png" style="width:60.0%;height:60.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Principal component analysis (PCA) of blastoid-derived ELCs, HLCs and TLCs relative to published maps from human embryos and established human PSC lines</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="comparison-w-cynomolgus-monkeys" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="comparison-w-cynomolgus-monkeys">Comparison w/ cynomolgus monkeys</h2>
<p><br></p>
<p><a href="https://doi.org/10.1038/nature19096">A developmental coordinate of pluripotency among mice, monkeys and humans</a></p>
<ul>
<li>BioProject Accession: PRJNA301445</li>
<li>GEO Accession: GSE74767</li>
<li>Notebook: <a href="https://jlduan.github.io/replica/nature19096">https://jlduan.github.io/replica/nature19096</a>
</li>
</ul>
<section id="data-loading" class="level3"><h3 class="anchored" data-anchor-id="data-loading">Data loading</h3>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">color_palette_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"0"</span> <span class="op">=</span> <span class="st">"#8DD3C7"</span>,</span>
<span>    <span class="st">"1"</span> <span class="op">=</span> <span class="st">"#9EDAE5FF"</span>,</span>
<span>    <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#BEBADA"</span>,</span>
<span>    <span class="st">"3"</span> <span class="op">=</span> <span class="st">"#FB8072"</span>,</span>
<span>    <span class="st">"4"</span> <span class="op">=</span> <span class="st">"#80B1D3"</span>,</span>
<span>    <span class="st">"5"</span> <span class="op">=</span> <span class="st">"#FDB462"</span>,</span>
<span>    <span class="st">"6"</span> <span class="op">=</span> <span class="st">"#B3DE69"</span>,</span>
<span>    <span class="st">"7"</span> <span class="op">=</span> <span class="st">"#FCCDE5"</span>,</span>
<span>    <span class="st">"8"</span> <span class="op">=</span> <span class="st">"#DC863B"</span>,</span>
<span>    <span class="st">"9"</span> <span class="op">=</span> <span class="st">"#BC80BD"</span>,</span>
<span>    <span class="st">"10"</span> <span class="op">=</span> <span class="st">"#11c638"</span>,</span>
<span>    <span class="st">"11"</span> <span class="op">=</span> <span class="st">"#BCBD22FF"</span>,</span>
<span>    <span class="st">"12"</span> <span class="op">=</span> <span class="st">"#17BECFFF"</span>,</span>
<span>    <span class="st">"13"</span> <span class="op">=</span> <span class="st">"#AEC7E8FF"</span>,</span>
<span>    <span class="st">"14"</span> <span class="op">=</span> <span class="st">"#EAD3C6"</span>,</span>
<span>    <span class="st">"15"</span> <span class="op">=</span> <span class="st">"#98DF8AFF"</span>,</span>
<span>    <span class="st">"16"</span> <span class="op">=</span> <span class="st">"#FF9896FF"</span>,</span>
<span>    <span class="st">"17"</span> <span class="op">=</span> <span class="st">"#C5B0D5FF"</span>,</span>
<span>    <span class="st">"18"</span> <span class="op">=</span> <span class="st">"#C49C94FF"</span>,</span>
<span>    <span class="st">"19"</span> <span class="op">=</span> <span class="st">"#F7B6D2FF"</span>,</span>
<span>    <span class="st">"20"</span> <span class="op">=</span> <span class="st">"#D33F6A"</span>,</span>
<span>    <span class="st">"21"</span> <span class="op">=</span> <span class="st">"#8E063B"</span>,</span>
<span>    <span class="st">"22"</span> <span class="op">=</span> <span class="st">"#023FA5"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare matrix</span></span>
<span><span class="va">matrix_cpm_PRJNA301445_cy</span> <span class="op">&lt;-</span> <span class="fu">load_matrix</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">PROJECT_DIR</span>, <span class="st">"raw/public/PRJNA301445/preprocessed/cy"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">embedding_PRJNA301445_cy</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"raw/public/PRJNA301445/Comparison/cy_EPI/embedding_cy.csv"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">group</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="st">"ICM"</span>,</span>
<span>                <span class="st">"Pre-EPI"</span>,</span>
<span>                <span class="st">"Hypoblast"</span>,</span>
<span>                <span class="st">"PreE-TE"</span>,</span>
<span>                <span class="st">"PreL-TE"</span>,</span>
<span>                <span class="st">"PostE-EPI"</span>,</span>
<span>                <span class="st">"PostL-EPI"</span>,</span>
<span>                <span class="st">"Gast1"</span>,</span>
<span>                <span class="st">"Gast2a"</span>,</span>
<span>                <span class="st">"Gast2b"</span>,</span>
<span>                <span class="st">"Post-paTE"</span>,</span>
<span>                <span class="st">"VE/YE"</span>,</span>
<span>                <span class="st">"EXMC"</span>,</span>
<span>                <span class="st">"cyESCFF"</span>,</span>
<span>                <span class="st">"cyESCoF"</span></span>
<span>                <span class="co"># "E5.5EPI",</span></span>
<span>                <span class="co"># "E5.5VE",</span></span>
<span>                <span class="co"># "E6.5EPI-T hi",</span></span>
<span>                <span class="co"># "E6.5EPI-T lo",</span></span>
<span>                <span class="co"># "E6.5VE",</span></span>
<span>                <span class="co"># "EpiLC",</span></span>
<span>                <span class="co"># "2i+L ESC"</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_cpm_PRJNA301445_cy_pseudobulk_lineage</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">embedding_PRJNA301445_cy</span><span class="op">$</span><span class="va">group</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_in_group</span> <span class="op">&lt;-</span> <span class="va">embedding_PRJNA301445_cy</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>                <span class="va">group</span> <span class="op">==</span> <span class="va">x</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span>        <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">matrix_cpm_PRJNA301445_cy</span><span class="op">[</span>, <span class="va">cells_in_group</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">cbind</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">embedding_PRJNA301445_cy</span><span class="op">$</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">matrix_cpm_PRJNA301445_cy</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">embedding_PRJNA301445_cy</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># prepare features</span></span>
<span><span class="va">features_hg_cy_EPI_HYP_TE_hg</span> <span class="op">&lt;-</span> <span class="va">features_hg_cy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>        <span class="va">hg</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="va">features_hg_cy_EPI_hg</span>,</span>
<span>                <span class="va">features_hg_cy_HYP_hg</span>,</span>
<span>                <span class="va">features_hg_cy_TE_hg</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">hg</span><span class="op">)</span></span>
<span></span>
<span><span class="va">features_hg_cy_EPI_HYP_TE_cy</span> <span class="op">&lt;-</span> <span class="va">features_hg_cy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>        <span class="va">hg</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="va">features_hg_cy_EPI_hg</span>,</span>
<span>                <span class="va">features_hg_cy_HYP_hg</span>,</span>
<span>                <span class="va">features_hg_cy_TE_hg</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cy</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="correlation-heatmap" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="correlation-heatmap">Correlation heatmap</h3>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>    <span class="fu">calc_cpm</span><span class="op">(</span></span>
<span>        <span class="va">matrix_readcount_blastoid_pseudobulk</span></span>
<span>    <span class="op">)</span><span class="op">[</span><span class="va">features_hg_cy_EPI_HYP_TE_hg</span>, <span class="op">]</span>,</span>
<span>    <span class="va">matrix_cpm_PRJNA301445_cy_pseudobulk_lineage</span><span class="op">[</span></span>
<span>        <span class="va">features_hg_cy_EPI_HYP_TE_cy</span>,</span>
<span>    <span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">matrix_corr</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span> <span class="op">&lt;-</span> <span class="va">matrix_heatmap_corr_EPI_HYP_TE</span><span class="op">[</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"11"</span>, <span class="st">"18"</span>, <span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"8"</span>, <span class="st">"9"</span>, <span class="st">"12"</span>, <span class="st">"17"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"ICM"</span>, <span class="st">"Pre-EPI"</span>, <span class="st">"PostE-EPI"</span>, <span class="st">"PostL-EPI"</span>,</span>
<span>        <span class="st">"Gast1"</span>, <span class="st">"Gast2a"</span>, <span class="st">"Gast2b"</span>,</span>
<span>        <span class="st">"Hypoblast"</span>, <span class="st">"PreE-TE"</span>, <span class="st">"PreL-TE"</span>, <span class="st">"Post-paTE"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"EPI"</span>, <span class="st">"HYP"</span>, <span class="st">"TE"</span><span class="op">)</span>,</span>
<span>        times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span><span class="op">)</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">":"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<p>Preview correlations.</p>
<div class="cell page-columns page-full">
<details><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">`EPI:ICM`</span><span class="op">:</span><span class="va">`TE:Post-paTE`</span><span class="op">)</span>, decimals <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/data_color.html">data_color</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">`EPI:ICM`</span><span class="op">:</span><span class="va">`TE:Post-paTE`</span><span class="op">)</span>,</span>
<span>        colors <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/col_numeric.html">col_numeric</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#63BE7B"</span>, <span class="st">"#FFEB84"</span>, <span class="st">"#F87274"</span><span class="op">)</span>,</span>
<span>            domain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cols_align.html">cols_align</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"center"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/cols_width.html">cols_width</a></span><span class="op">(</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/px.html">px</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display column-body-outset">

<div id="breunrgfzm" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#breunrgfzm .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#breunrgfzm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#breunrgfzm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#breunrgfzm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#breunrgfzm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#breunrgfzm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#breunrgfzm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#breunrgfzm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#breunrgfzm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#breunrgfzm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#breunrgfzm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#breunrgfzm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#breunrgfzm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#breunrgfzm .gt_from_md > :first-child {
  margin-top: 0;
}

#breunrgfzm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#breunrgfzm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#breunrgfzm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#breunrgfzm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#breunrgfzm .gt_row_group_first td {
  border-top-width: 2px;
}

#breunrgfzm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#breunrgfzm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#breunrgfzm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#breunrgfzm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#breunrgfzm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#breunrgfzm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#breunrgfzm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#breunrgfzm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#breunrgfzm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#breunrgfzm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#breunrgfzm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#breunrgfzm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#breunrgfzm .gt_left {
  text-align: left;
}

#breunrgfzm .gt_center {
  text-align: center;
}

#breunrgfzm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#breunrgfzm .gt_font_normal {
  font-weight: normal;
}

#breunrgfzm .gt_font_bold {
  font-weight: bold;
}

#breunrgfzm .gt_font_italic {
  font-style: italic;
}

#breunrgfzm .gt_super {
  font-size: 65%;
}

#breunrgfzm .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#breunrgfzm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#breunrgfzm .gt_indent_1 {
  text-indent: 5px;
}

#breunrgfzm .gt_indent_2 {
  text-indent: 10px;
}

#breunrgfzm .gt_indent_3 {
  text-indent: 15px;
}

#breunrgfzm .gt_indent_4 {
  text-indent: 20px;
}

#breunrgfzm .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 0px">
<colgroup>
<col style="width:60px;">
<col style="width:60px;">
<col style="width:60px;">
<col style="width:60px;">
<col style="width:60px;">
<col style="width:60px;">
<col style="width:60px;">
<col style="width:60px;">
<col style="width:60px;">
<col style="width:60px;">
<col style="width:60px;">
<col style="width:60px;">
</colgroup>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="cluster">cluster</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="EPI:ICM">EPI:ICM</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="EPI:Pre-EPI">EPI:Pre-EPI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="EPI:PostE-EPI">EPI:PostE-EPI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="EPI:PostL-EPI">EPI:PostL-EPI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="EPI:Gast1">EPI:Gast1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="EPI:Gast2a">EPI:Gast2a</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="EPI:Gast2b">EPI:Gast2b</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="HYP:Hypoblast">HYP:Hypoblast</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="TE:PreE-TE">TE:PreE-TE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="TE:PreL-TE">TE:PreL-TE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="TE:Post-paTE">TE:Post-paTE</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="cluster" class="gt_row gt_center">11</td>
<td headers="EPI:ICM" class="gt_row gt_center" style="background-color: #FFCE80; color: #000000;">0.41</td>
<td headers="EPI:Pre-EPI" class="gt_row gt_center" style="background-color: #FD9C7A; color: #000000;">0.55</td>
<td headers="EPI:PostE-EPI" class="gt_row gt_center" style="background-color: #FDA37B; color: #000000;">0.53</td>
<td headers="EPI:PostL-EPI" class="gt_row gt_center" style="background-color: #FFC07F; color: #000000;">0.45</td>
<td headers="EPI:Gast1" class="gt_row gt_center" style="background-color: #FFCA80; color: #000000;">0.43</td>
<td headers="EPI:Gast2a" class="gt_row gt_center" style="background-color: #FCEA84; color: #000000;">0.33</td>
<td headers="EPI:Gast2b" class="gt_row gt_center" style="background-color: #F4E883; color: #000000;">0.31</td>
<td headers="HYP:Hypoblast" class="gt_row gt_center" style="background-color: #CCDC81; color: #000000;">0.22</td>
<td headers="TE:PreE-TE" class="gt_row gt_center" style="background-color: #FFE583; color: #000000;">0.35</td>
<td headers="TE:PreL-TE" class="gt_row gt_center" style="background-color: #E9E483; color: #000000;">0.28</td>
<td headers="TE:Post-paTE" class="gt_row gt_center" style="background-color: #96CC7E; color: #000000;">0.11</td>
</tr>
<tr>
<td headers="cluster" class="gt_row gt_center">18</td>
<td headers="EPI:ICM" class="gt_row gt_center" style="background-color: #FFC67F; color: #000000;">0.44</td>
<td headers="EPI:Pre-EPI" class="gt_row gt_center" style="background-color: #FAEA84; color: #000000;">0.32</td>
<td headers="EPI:PostE-EPI" class="gt_row gt_center" style="background-color: #BED780; color: #000000;">0.19</td>
<td headers="EPI:PostL-EPI" class="gt_row gt_center" style="background-color: #D0DD81; color: #000000;">0.23</td>
<td headers="EPI:Gast1" class="gt_row gt_center" style="background-color: #E4E382; color: #000000;">0.27</td>
<td headers="EPI:Gast2a" class="gt_row gt_center" style="background-color: #F4E883; color: #000000;">0.31</td>
<td headers="EPI:Gast2b" class="gt_row gt_center" style="background-color: #FFEA84; color: #000000;">0.34</td>
<td headers="HYP:Hypoblast" class="gt_row gt_center" style="background-color: #FA7F76; color: #000000;">0.62</td>
<td headers="TE:PreE-TE" class="gt_row gt_center" style="background-color: #FFCC80; color: #000000;">0.42</td>
<td headers="TE:PreL-TE" class="gt_row gt_center" style="background-color: #FFC27F; color: #000000;">0.45</td>
<td headers="TE:Post-paTE" class="gt_row gt_center" style="background-color: #E6E483; color: #000000;">0.28</td>
</tr>
<tr>
<td headers="cluster" class="gt_row gt_center">0</td>
<td headers="EPI:ICM" class="gt_row gt_center" style="background-color: #F9E984; color: #000000;">0.32</td>
<td headers="EPI:Pre-EPI" class="gt_row gt_center" style="background-color: #E5E383; color: #000000;">0.28</td>
<td headers="EPI:PostE-EPI" class="gt_row gt_center" style="background-color: #B4D580; color: #000000;">0.17</td>
<td headers="EPI:PostL-EPI" class="gt_row gt_center" style="background-color: #B8D680; color: #000000;">0.18</td>
<td headers="EPI:Gast1" class="gt_row gt_center" style="background-color: #C3D980; color: #000000;">0.20</td>
<td headers="EPI:Gast2a" class="gt_row gt_center" style="background-color: #A1CF7E; color: #000000;">0.13</td>
<td headers="EPI:Gast2b" class="gt_row gt_center" style="background-color: #C1D880; color: #000000;">0.20</td>
<td headers="HYP:Hypoblast" class="gt_row gt_center" style="background-color: #E8E483; color: #000000;">0.28</td>
<td headers="TE:PreE-TE" class="gt_row gt_center" style="background-color: #FFCE80; color: #000000;">0.42</td>
<td headers="TE:PreL-TE" class="gt_row gt_center" style="background-color: #FEA77B; color: #000000;">0.52</td>
<td headers="TE:Post-paTE" class="gt_row gt_center" style="background-color: #F87274; color: #FFFFFF;">0.65</td>
</tr>
<tr>
<td headers="cluster" class="gt_row gt_center">1</td>
<td headers="EPI:ICM" class="gt_row gt_center" style="background-color: #FFCC80; color: #000000;">0.42</td>
<td headers="EPI:Pre-EPI" class="gt_row gt_center" style="background-color: #FFD681; color: #000000;">0.39</td>
<td headers="EPI:PostE-EPI" class="gt_row gt_center" style="background-color: #E7E483; color: #000000;">0.28</td>
<td headers="EPI:PostL-EPI" class="gt_row gt_center" style="background-color: #E6E383; color: #000000;">0.28</td>
<td headers="EPI:Gast1" class="gt_row gt_center" style="background-color: #F1E783; color: #000000;">0.30</td>
<td headers="EPI:Gast2a" class="gt_row gt_center" style="background-color: #CEDC81; color: #000000;">0.23</td>
<td headers="EPI:Gast2b" class="gt_row gt_center" style="background-color: #E8E483; color: #000000;">0.28</td>
<td headers="HYP:Hypoblast" class="gt_row gt_center" style="background-color: #FFE483; color: #000000;">0.35</td>
<td headers="TE:PreE-TE" class="gt_row gt_center" style="background-color: #FFB57D; color: #000000;">0.48</td>
<td headers="TE:PreL-TE" class="gt_row gt_center" style="background-color: #FC9679; color: #000000;">0.56</td>
<td headers="TE:Post-paTE" class="gt_row gt_center" style="background-color: #FD9F7A; color: #000000;">0.54</td>
</tr>
<tr>
<td headers="cluster" class="gt_row gt_center">8</td>
<td headers="EPI:ICM" class="gt_row gt_center" style="background-color: #FFDC82; color: #000000;">0.38</td>
<td headers="EPI:Pre-EPI" class="gt_row gt_center" style="background-color: #FFDA82; color: #000000;">0.38</td>
<td headers="EPI:PostE-EPI" class="gt_row gt_center" style="background-color: #FDEA84; color: #000000;">0.33</td>
<td headers="EPI:PostL-EPI" class="gt_row gt_center" style="background-color: #FFE383; color: #000000;">0.36</td>
<td headers="EPI:Gast1" class="gt_row gt_center" style="background-color: #FFDA82; color: #000000;">0.38</td>
<td headers="EPI:Gast2a" class="gt_row gt_center" style="background-color: #F2E783; color: #000000;">0.31</td>
<td headers="EPI:Gast2b" class="gt_row gt_center" style="background-color: #FFE083; color: #000000;">0.36</td>
<td headers="HYP:Hypoblast" class="gt_row gt_center" style="background-color: #FFDC82; color: #000000;">0.38</td>
<td headers="TE:PreE-TE" class="gt_row gt_center" style="background-color: #FFBF7E; color: #000000;">0.46</td>
<td headers="TE:PreL-TE" class="gt_row gt_center" style="background-color: #FC9879; color: #000000;">0.56</td>
<td headers="TE:Post-paTE" class="gt_row gt_center" style="background-color: #FB8777; color: #000000;">0.60</td>
</tr>
<tr>
<td headers="cluster" class="gt_row gt_center">9</td>
<td headers="EPI:ICM" class="gt_row gt_center" style="background-color: #C5DA81; color: #000000;">0.21</td>
<td headers="EPI:Pre-EPI" class="gt_row gt_center" style="background-color: #B1D47F; color: #000000;">0.16</td>
<td headers="EPI:PostE-EPI" class="gt_row gt_center" style="background-color: #7DC57C; color: #000000;">0.06</td>
<td headers="EPI:PostL-EPI" class="gt_row gt_center" style="background-color: #7CC47C; color: #000000;">0.06</td>
<td headers="EPI:Gast1" class="gt_row gt_center" style="background-color: #8EC97D; color: #000000;">0.09</td>
<td headers="EPI:Gast2a" class="gt_row gt_center" style="background-color: #63BE7B; color: #000000;">0.01</td>
<td headers="EPI:Gast2b" class="gt_row gt_center" style="background-color: #8FCA7D; color: #000000;">0.09</td>
<td headers="HYP:Hypoblast" class="gt_row gt_center" style="background-color: #AAD27F; color: #000000;">0.15</td>
<td headers="TE:PreE-TE" class="gt_row gt_center" style="background-color: #EDE683; color: #000000;">0.29</td>
<td headers="TE:PreL-TE" class="gt_row gt_center" style="background-color: #FFD081; color: #000000;">0.41</td>
<td headers="TE:Post-paTE" class="gt_row gt_center" style="background-color: #FC9278; color: #000000;">0.58</td>
</tr>
<tr>
<td headers="cluster" class="gt_row gt_center">12</td>
<td headers="EPI:ICM" class="gt_row gt_center" style="background-color: #FFDF83; color: #000000;">0.37</td>
<td headers="EPI:Pre-EPI" class="gt_row gt_center" style="background-color: #FFD381; color: #000000;">0.40</td>
<td headers="EPI:PostE-EPI" class="gt_row gt_center" style="background-color: #FFEB84; color: #000000;">0.33</td>
<td headers="EPI:PostL-EPI" class="gt_row gt_center" style="background-color: #F8E984; color: #000000;">0.32</td>
<td headers="EPI:Gast1" class="gt_row gt_center" style="background-color: #FFE784; color: #000000;">0.34</td>
<td headers="EPI:Gast2a" class="gt_row gt_center" style="background-color: #DDE182; color: #000000;">0.26</td>
<td headers="EPI:Gast2b" class="gt_row gt_center" style="background-color: #F1E783; color: #000000;">0.30</td>
<td headers="HYP:Hypoblast" class="gt_row gt_center" style="background-color: #FBEA84; color: #000000;">0.33</td>
<td headers="TE:PreE-TE" class="gt_row gt_center" style="background-color: #FFD281; color: #000000;">0.40</td>
<td headers="TE:PreL-TE" class="gt_row gt_center" style="background-color: #FFB97E; color: #000000;">0.47</td>
<td headers="TE:Post-paTE" class="gt_row gt_center" style="background-color: #FFC880; color: #000000;">0.43</td>
</tr>
<tr>
<td headers="cluster" class="gt_row gt_center">17</td>
<td headers="EPI:ICM" class="gt_row gt_center" style="background-color: #F3E883; color: #000000;">0.31</td>
<td headers="EPI:Pre-EPI" class="gt_row gt_center" style="background-color: #F3E783; color: #000000;">0.31</td>
<td headers="EPI:PostE-EPI" class="gt_row gt_center" style="background-color: #D5DE82; color: #000000;">0.24</td>
<td headers="EPI:PostL-EPI" class="gt_row gt_center" style="background-color: #D4DE81; color: #000000;">0.24</td>
<td headers="EPI:Gast1" class="gt_row gt_center" style="background-color: #DEE182; color: #000000;">0.26</td>
<td headers="EPI:Gast2a" class="gt_row gt_center" style="background-color: #B6D580; color: #000000;">0.17</td>
<td headers="EPI:Gast2b" class="gt_row gt_center" style="background-color: #D5DE82; color: #000000;">0.24</td>
<td headers="HYP:Hypoblast" class="gt_row gt_center" style="background-color: #DEE182; color: #000000;">0.26</td>
<td headers="TE:PreE-TE" class="gt_row gt_center" style="background-color: #FFDB82; color: #000000;">0.38</td>
<td headers="TE:PreL-TE" class="gt_row gt_center" style="background-color: #FFB77D; color: #000000;">0.48</td>
<td headers="TE:Post-paTE" class="gt_row gt_center" style="background-color: #FC9679; color: #000000;">0.56</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ha_group</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span></span>
<span>    string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span><span class="op">)</span>,</span>
<span>    pattern <span class="op">=</span> <span class="st">":.+$"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ha_column</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html">HeatmapAnnotation</a></span><span class="op">(</span></span>
<span>    lineage <span class="op">=</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_simple.html">anno_simple</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span><span class="op">)</span>,</span>
<span>        <span class="co"># pch = anno_labels_cluster,</span></span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>            object <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/hue_pal.html">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            nm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        which <span class="op">=</span> <span class="st">"column"</span>,</span>
<span>        pt_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>        pt_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>            fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>            fontsize <span class="op">=</span> <span class="fl">5</span></span>
<span>        <span class="op">)</span>,</span>
<span>        simple_anno_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    annotation_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"Lineage"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    annotation_name_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"Arial"</span>, fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    annotation_name_side <span class="op">=</span> <span class="st">"left"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ha_left</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html">HeatmapAnnotation</a></span><span class="op">(</span></span>
<span>    cluster <span class="op">=</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_simple.html">anno_simple</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="va">color_palette_cluster</span>,</span>
<span>        which <span class="op">=</span> <span class="st">"row"</span>,</span>
<span>        <span class="co"># pt_size = unit(2, "mm"),</span></span>
<span>        pt_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>            fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>            fontsize <span class="op">=</span> <span class="fl">5</span></span>
<span>        <span class="op">)</span>,</span>
<span>        simple_anno_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co">#</span></span>
<span>    lineage <span class="op">=</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_simple.html">anno_simple</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html">enframe</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>                color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>                    <span class="va">value</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span> <span class="op">~</span> <span class="st">"EPI"</span>,</span>
<span>                    <span class="va">value</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18</span><span class="op">)</span> <span class="op">~</span> <span class="st">"HYP"</span>,</span>
<span>                    <span class="va">value</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">12</span>, <span class="fl">17</span><span class="op">)</span> <span class="op">~</span> <span class="st">"TE"</span>,</span>
<span>                    <span class="va">value</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">14</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Pre-lineage"</span>,</span>
<span>                    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Blastoid"</span></span>
<span>                <span class="op">)</span></span>
<span>            <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>            object <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey70"</span>, <span class="st">"#8ace7e"</span>, <span class="st">"#ff684c"</span>, <span class="st">"#9467bd"</span>, <span class="st">"#ffd8b1"</span><span class="op">)</span>,</span>
<span>            nm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Blastoid"</span>, <span class="st">"EPI"</span>, <span class="st">"HYP"</span>, <span class="st">"TE"</span>, <span class="st">"Pre-lineage"</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        which <span class="op">=</span> <span class="st">"row"</span>,</span>
<span>        <span class="co"># pt_size = unit(2, "mm"),</span></span>
<span>        pt_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>            fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>            fontsize <span class="op">=</span> <span class="fl">5</span></span>
<span>        <span class="op">)</span>,</span>
<span>        simple_anno_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># ,</span></span>
<span>    which <span class="op">=</span> <span class="st">"row"</span>,</span>
<span>    show_annotation_name <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    annotation_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"Cluster"</span>,</span>
<span>        <span class="st">"Lineage"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    annotation_name_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"Arial"</span>, fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">colors_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span></span>
<span>    <span class="fu">wesanderson</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html">wes_palette</a></span><span class="op">(</span><span class="st">"Zissou1"</span>, <span class="fl">10</span>, type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">col_fun</span> <span class="op">&lt;-</span> <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    <span class="co"># viridis::plasma(11)</span></span>
<span>    <span class="co"># wesanderson::wes_palette("Zissou1", 51, type = "continuous")</span></span>
<span>    <span class="va">colors_</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ht</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span></span>
<span>    <span class="va">matrix_heatmap_corr_EPI_HYP_TE</span>,</span>
<span>    <span class="co"># name = "heatmap",</span></span>
<span>    <span class="co"># col = wesanderson::wes_palette("Zissou1", 50, type = "continuous"),</span></span>
<span>    col <span class="op">=</span> <span class="va">col_fun</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    cell_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">j</span>, <span class="va">i</span>, <span class="va">x</span>, <span class="va">y</span>, <span class="va">width</span>, <span class="va">height</span>, <span class="va">fill</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># grid::grid.text(</span></span>
<span>        <span class="co">#     sprintf("%.2f", corr_heatmap[i, j]), x, y,</span></span>
<span>        <span class="co">#     gp = grid::gpar(fontsize = 6)</span></span>
<span>        <span class="co"># )</span></span>
<span>        <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html">grid.text</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>            <span class="va">x</span>, <span class="va">y</span>,</span>
<span>            gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="co">#</span></span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="co"># row_labels = NA,</span></span>
<span>    row_names_side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span><span class="op">)</span>,</span>
<span>    row_names_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"Arial"</span>, fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    show_row_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co">#</span></span>
<span>    column_labels <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span></span>
<span>        string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr_EPI_HYP_TE</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"^.+:"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    column_names_side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"top"</span><span class="op">)</span>,</span>
<span>    column_names_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"Arial"</span>, fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="op">-</span><span class="fl">90</span>,</span>
<span>    show_column_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co">#</span></span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    <span class="co">#</span></span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    show_column_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    <span class="co">#</span></span>
<span>    top_annotation <span class="op">=</span> <span class="va">ha_column</span>,</span>
<span>    left_annotation <span class="op">=</span> <span class="va">ha_left</span>,</span>
<span>    <span class="co">#</span></span>
<span>    heatmap_legend_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Corr"</span>,</span>
<span>        title_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>            fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>            fontsize <span class="op">=</span> <span class="fl">6</span></span>
<span>        <span class="op">)</span>,</span>
<span>        legend_direction <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>        labels_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>            fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>            fontsize <span class="op">=</span> <span class="fl">5</span></span>
<span>        <span class="op">)</span>,</span>
<span>        legend_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">15</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>        legend_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"mm"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co">#</span></span>
<span>    column_split <span class="op">=</span> <span class="va">ha_group</span>,</span>
<span>    column_gap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    column_title_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"Arial"</span>, fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    column_title_rot <span class="op">=</span> <span class="op">-</span><span class="fl">90</span>,</span>
<span>    column_title <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># legend</span></span>
<span><span class="va">lgd_species</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html">Legend</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Monkey"</span>, <span class="st">"Human"</span><span class="op">)</span>,</span>
<span>    <span class="co">#</span></span>
<span>    grid_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="st">"mm"</span><span class="op">)</span>, grid_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    <span class="co">#</span></span>
<span>    legend_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>        fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cynomolgus Monkey"</span> <span class="op">=</span> <span class="st">"#3D79F3FF"</span>, <span class="st">"Human"</span> <span class="op">=</span> <span class="st">"#34A74BFF"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    labels_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>        fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>        fontsize <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span>,</span>
<span>    title_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>        fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>        fontsize <span class="op">=</span> <span class="fl">6</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">lgd_colorbar</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html">Legend</a></span><span class="op">(</span></span>
<span>    col_fun <span class="op">=</span> <span class="va">col_fun</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Corr"</span>,</span>
<span>    grid_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    grid_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    legend_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    legend_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    title_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>        fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>        fontsize <span class="op">=</span> <span class="fl">6</span></span>
<span>    <span class="op">)</span>,</span>
<span>    labels_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>        fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>        fontsize <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">lgd_lineage</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html">Legend</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Lineage"</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ELCs"</span>, <span class="st">"HLCs"</span>, <span class="st">"TLCs"</span><span class="op">)</span>,</span>
<span>    <span class="co">#</span></span>
<span>    grid_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="st">"mm"</span><span class="op">)</span>, grid_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    <span class="co">#</span></span>
<span>    legend_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>        fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="st">"ELCs"</span> <span class="op">=</span> <span class="st">"#8ace7e"</span>,</span>
<span>            <span class="st">"HLCs"</span> <span class="op">=</span> <span class="st">"#ff684c"</span>,</span>
<span>            <span class="st">"TLCs"</span> <span class="op">=</span> <span class="st">"#9467bd"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    labels_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>        fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>        fontsize <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span>,</span>
<span>    title_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>        fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>        fontsize <span class="op">=</span> <span class="fl">6</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/packLegend.html">packLegend</a></span><span class="op">(</span></span>
<span>    <span class="co"># lgd_cluster,</span></span>
<span>    <span class="va">lgd_colorbar</span>,</span>
<span>    <span class="va">lgd_lineage</span>,</span>
<span>    <span class="co"># lgd_species,</span></span>
<span>    gap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    direction <span class="op">=</span> <span class="st">"vertical"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span></span>
<span>    <span class="va">ht</span>,</span>
<span>    heatmap_legend_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">pd</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="compare_blastoids_files/figure-html/unnamed-chunk-63-1.png" style="width:90.0%;height:90.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="derived-stem-cells" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="derived-stem-cells">Derived stem cells</h2>
<section id="data-loading-1" class="level3"><h3 class="anchored" data-anchor-id="data-loading-1">Data loading</h3>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_5iLA</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>,</span>
<span>        <span class="st">"raw/naive_human_PSC"</span>,</span>
<span>        <span class="st">"matrix"</span>,</span>
<span>        <span class="st">"xaa_Aligned.sortedByCoord.out_deduped_q10_gene_id_featureCounts.txt.gz"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    col_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    skip <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_5iLA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">Matrix</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">matrix_readcount_5iLA</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="va">matrix_readcount_5iLA</span><span class="op">[</span>, <span class="fl">1</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"5iLA-1"</span>, <span class="st">"5iLA-2"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    sparse <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="correlation-heatmap-1" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="correlation-heatmap-1">Correlation heatmap</h3>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>    <span class="va">matrix_readcount_stem_pseudobulk</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LW49"</span>, <span class="st">"LW50"</span>, <span class="st">"LW51"</span>, <span class="st">"LW52"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    <span class="st">"5iLA"</span> <span class="op">=</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">matrix_readcount_5iLA</span><span class="op">)</span>,</span>
<span>    <span class="va">matrix_readcount_PRJEB7132_pseudobulk</span>,</span>
<span>    <span class="va">matrix_readcount_PRJNA576801_pseudobulk_lineage</span>,</span>
<span>    <span class="va">matrix_readcount_PRJNA638350_pseudobulk_lineage</span><span class="op">[</span></span>
<span>        ,</span>
<span>        <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount_PRJNA638350_pseudobulk_lineage</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="st">"FT190"</span>, <span class="st">"Hec116"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">]</span>,</span>
<span>    <span class="va">matrix_readcount_PRJNA574150_pseudobulk_lineage</span><span class="op">[</span>, <span class="st">"nEnd"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_corr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"WIBR3-5i/L/A, scRNA-Seq"</span>,</span>
<span>    <span class="st">"Blastoid naïve ES cells"</span>,</span>
<span>    <span class="st">"Blastoid nEND"</span>,</span>
<span>    <span class="st">"Blastoid TSCs"</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="st">"WIBR3-5i/L/A, bulk"</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="st">"PRJEB7132:H9 Primed"</span>,</span>
<span>    <span class="st">"PRJEB7132:H9 Reset"</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="st">"PRJNA576801:Naïve ES cells"</span>,</span>
<span>    <span class="st">"PRJNA576801:TSCs"</span>,</span>
<span>    <span class="st">"PRJNA576801:Primed ES cells"</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="st">"PRJNA638350:Naïve ES cells"</span>,</span>
<span>    <span class="st">"PRJNA638350:Primed ES cells"</span>,</span>
<span>    <span class="st">"PRJNA638350:TSCs (TD)"</span>,</span>
<span>    <span class="st">"PRJNA638350:TSCs"</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="st">"PRJNA574150:nEND"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">features_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="va">features_hg_cy_EPI_hg</span>,</span>
<span>    <span class="va">features_hg_cy_HYP_hg</span>,</span>
<span>    <span class="va">features_hg_cy_TE_hg</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_heatmap_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fu">calc_cpm</span><span class="op">(</span><span class="va">matrix_corr</span><span class="op">)</span><span class="op">[</span><span class="va">features_</span>, <span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">column_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html">enframe</a></span><span class="op">(</span>value <span class="op">=</span> <span class="st">"sample_name"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        a <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">sample_name</span>, pattern <span class="op">=</span> <span class="st">":.+$"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span></span>
<span>        <span class="va">studies</span>,</span>
<span>        by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span> <span class="op">=</span> <span class="st">"bioproject"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sample_name</span>, <span class="va">a</span>, <span class="va">description</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        label <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">description</span><span class="op">)</span> <span class="op">~</span> <span class="va">sample_name</span>,</span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">sample_name</span>, <span class="va">description</span>, sep <span class="op">=</span> <span class="st">"; "</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        label <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span></span>
<span>            string <span class="op">=</span> <span class="va">label</span>,</span>
<span>            pattern <span class="op">=</span> <span class="st">".+:"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">label</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">col_fun</span> <span class="op">&lt;-</span> <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>    <span class="co"># viridis::plasma(11)</span></span>
<span>    <span class="co"># wesanderson::wes_palette("Zissou1", 51, type = "continuous")</span></span>
<span>    <span class="co">#</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span></span>
<span>        <span class="fu">wesanderson</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html">wes_palette</a></span><span class="op">(</span><span class="st">"Zissou1"</span>, <span class="fl">10</span>, type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ht</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span></span>
<span>    <span class="va">matrix_heatmap_corr</span>,</span>
<span>    <span class="co"># name = "heatmap",</span></span>
<span>    <span class="co"># col = wesanderson::wes_palette("Zissou1", 50, type = "continuous"),</span></span>
<span>    col <span class="op">=</span> <span class="va">col_fun</span>,</span>
<span>    border <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    rect_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"white"</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    cell_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">j</span>, <span class="va">i</span>, <span class="va">x</span>, <span class="va">y</span>, <span class="va">width</span>, <span class="va">height</span>, <span class="va">fill</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html">grid.text</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">matrix_heatmap_corr</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>            <span class="va">x</span>, <span class="va">y</span>,</span>
<span>            gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="co">#</span></span>
<span>    cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    <span class="co">#</span></span>
<span>    row_labels <span class="op">=</span> <span class="va">column_labels</span>,</span>
<span>    row_names_side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span><span class="op">)</span>,</span>
<span>    row_names_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"Arial"</span>, fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    show_row_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co">#</span></span>
<span>    column_labels <span class="op">=</span> <span class="va">column_labels</span>,</span>
<span>    column_names_side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"top"</span><span class="op">)</span>,</span>
<span>    column_names_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"Arial"</span>, fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    <span class="co"># column_names_rot = -90,</span></span>
<span>    column_names_rot <span class="op">=</span> <span class="op">-</span><span class="fl">45</span>,</span>
<span>    show_column_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co">#</span></span>
<span>    show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    <span class="co">#</span></span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    show_column_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="co"># top_annotation = ha_column,</span></span>
<span>    <span class="co"># left_annotation = ha_left,</span></span>
<span>    <span class="co">#</span></span>
<span>    heatmap_legend_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Corr"</span>,</span>
<span>        title_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>            fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>            fontsize <span class="op">=</span> <span class="fl">6</span></span>
<span>        <span class="op">)</span>,</span>
<span>        legend_direction <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>        labels_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span></span>
<span>            fontfamily <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>            fontsize <span class="op">=</span> <span class="fl">5</span></span>
<span>        <span class="op">)</span>,</span>
<span>        legend_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">15</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>        legend_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"mm"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co">#</span></span>
<span>    <span class="co"># column_split = ha_group,</span></span>
<span>    column_gap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    column_title_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html">gpar</a></span><span class="op">(</span>fontfamily <span class="op">=</span> <span class="st">"Arial"</span>, fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    column_title_rot <span class="op">=</span> <span class="op">-</span><span class="fl">90</span>,</span>
<span>    column_title <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fig-cap-location-top page-columns page-full" data-layout-align="center">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-body-outset">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="compare_blastoids_files/figure-html/unnamed-chunk-71-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Correlation analysis of blastoid naïve ES cells, blastoid nEND and blastoid TSCs compared to published transcriptomes</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section></section><section id="r-session-info" class="level2"><h2 class="anchored" data-anchor-id="r-session-info">R session info</h2>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html">session_info</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.2.1 (2022-06-23)
 os       macOS Monterey 12.6
 system   aarch64, darwin21.6.0
 ui       unknown
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Chicago
 date     2022-09-24
 pandoc   2.19.2 @ /opt/homebrew/bin/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 package        * version       date (UTC) lib source
 BiocGenerics     0.42.0        2022-04-26 [1] Bioconductor
 bit              4.0.4         2020-08-04 [1] CRAN (R 4.2.0)
 bit64            4.0.5         2020-08-30 [1] CRAN (R 4.2.0)
 cachem           1.0.6         2021-08-19 [1] CRAN (R 4.2.0)
 Cairo            1.6-0         2022-07-05 [1] CRAN (R 4.2.1)
 callr            3.7.2         2022-08-22 [1] CRAN (R 4.2.1)
 cellranger       1.1.0         2016-07-27 [1] CRAN (R 4.2.0)
 circlize         0.4.15        2022-05-10 [1] CRAN (R 4.2.0)
 cli              3.4.1         2022-09-23 [1] CRAN (R 4.2.1)
 clue             0.3-61        2022-05-30 [1] CRAN (R 4.2.0)
 cluster          2.1.4         2022-08-22 [2] CRAN (R 4.2.1)
 codetools        0.2-18        2020-11-04 [2] CRAN (R 4.2.1)
 colorspace       2.0-3         2022-02-21 [1] CRAN (R 4.2.0)
 ComplexHeatmap   2.12.1        2022-08-09 [1] Bioconductor
 crayon           1.5.1         2022-03-26 [1] CRAN (R 4.2.0)
 devtools         2.4.4.9000    2022-09-23 [1] Github (r-lib/devtools@9e2793a)
 digest           0.6.29        2021-12-01 [1] CRAN (R 4.2.0)
 doParallel       1.0.17        2022-02-07 [1] CRAN (R 4.2.0)
 dplyr          * 1.0.99.9000   2022-09-23 [1] Github (tidyverse/dplyr@19c2be3)
 ellipsis         0.3.2         2021-04-29 [1] CRAN (R 4.2.0)
 evaluate         0.16          2022-08-09 [1] CRAN (R 4.2.1)
 extrafont      * 0.18          2022-04-12 [1] CRAN (R 4.2.0)
 extrafontdb      1.0           2012-06-11 [1] CRAN (R 4.2.0)
 fansi            1.0.3         2022-03-24 [1] CRAN (R 4.2.0)
 farver           2.1.1         2022-07-06 [1] CRAN (R 4.2.1)
 fastmap          1.1.0         2021-01-25 [1] CRAN (R 4.2.0)
 forcats        * 0.5.2.9000    2022-08-20 [1] Github (tidyverse/forcats@bd319e0)
 foreach          1.5.2         2022-02-02 [1] CRAN (R 4.2.0)
 fs               1.5.2.9000    2022-08-24 [1] Github (r-lib/fs@238032f)
 generics         0.1.3         2022-07-05 [1] CRAN (R 4.2.1)
 GetoptLong       1.0.5         2020-12-15 [1] CRAN (R 4.2.0)
 ggplot2        * 3.3.6.9000    2022-09-12 [1] Github (tidyverse/ggplot2@a58b48c)
 ggrepel          0.9.1         2021-01-15 [1] CRAN (R 4.2.0)
 GlobalOptions    0.1.2         2020-06-10 [1] CRAN (R 4.2.0)
 glue             1.6.2.9000    2022-04-22 [1] Github (tidyverse/glue@d47d6c7)
 gt               0.7.0.9000    2022-09-23 [1] Github (rstudio/gt@4030fb7)
 gtable           0.3.1.9000    2022-09-01 [1] Github (r-lib/gtable@c1a7a81)
 highr            0.9           2021-04-16 [1] CRAN (R 4.2.0)
 hms              1.1.2         2022-08-19 [1] CRAN (R 4.2.1)
 htmltools        0.5.3         2022-07-18 [1] CRAN (R 4.2.1)
 htmlwidgets      1.5.4         2022-08-23 [1] Github (ramnathv/htmlwidgets@400cf1a)
 httpuv           1.6.6         2022-09-08 [1] CRAN (R 4.2.1)
 IRanges          2.30.1        2022-08-18 [1] Bioconductor
 iterators        1.0.14        2022-02-05 [1] CRAN (R 4.2.0)
 jsonlite         1.8.0         2022-02-22 [1] CRAN (R 4.2.0)
 knitr            1.40          2022-08-24 [1] CRAN (R 4.2.1)
 labeling         0.4.2         2020-10-20 [1] CRAN (R 4.2.0)
 later            1.3.0         2021-08-18 [1] CRAN (R 4.2.0)
 lattice          0.20-45       2021-09-22 [2] CRAN (R 4.2.1)
 lifecycle        1.0.2.9000    2022-09-23 [1] Github (r-lib/lifecycle@0a6860a)
 lubridate      * 1.8.0.9000    2022-05-24 [1] Github (tidyverse/lubridate@0bb49b2)
 magick           2.7.3         2021-08-18 [1] CRAN (R 4.2.0)
 magrittr         2.0.3         2022-03-30 [1] CRAN (R 4.2.0)
 MASS             7.3-58.1      2022-08-03 [2] CRAN (R 4.2.1)
 Matrix         * 1.5-1         2022-09-13 [1] CRAN (R 4.2.1)
 matrixStats      0.62.0        2022-04-19 [1] CRAN (R 4.2.0)
 memoise          2.0.1         2021-11-26 [1] CRAN (R 4.2.0)
 mime             0.12          2021-09-28 [1] CRAN (R 4.2.0)
 miniUI           0.1.1.1       2018-05-18 [1] CRAN (R 4.2.0)
 munsell          0.5.0         2018-06-12 [1] CRAN (R 4.2.0)
 patchwork      * 1.1.2.9000    2022-08-20 [1] Github (thomasp85/patchwork@c14c960)
 pillar           1.8.1         2022-08-19 [1] CRAN (R 4.2.1)
 pkgbuild         1.3.1         2021-12-20 [1] CRAN (R 4.2.0)
 pkgconfig        2.0.3         2019-09-22 [1] CRAN (R 4.2.0)
 pkgload          1.3.0         2022-06-27 [1] CRAN (R 4.2.1)
 png              0.1-7         2013-12-03 [1] CRAN (R 4.2.0)
 prettyunits      1.1.1.9000    2022-04-22 [1] Github (r-lib/prettyunits@8706d89)
 processx         3.7.0         2022-07-07 [1] CRAN (R 4.2.1)
 profvis          0.3.7         2020-11-02 [1] CRAN (R 4.2.0)
 promises         1.2.0.1       2021-02-11 [1] CRAN (R 4.2.0)
 ps               1.7.1         2022-06-18 [1] CRAN (R 4.2.0)
 purrr          * 0.9000.0.9000 2022-09-24 [1] Github (tidyverse/purrr@4ab13f5)
 R.cache          0.16.0        2022-07-21 [1] CRAN (R 4.2.1)
 R.methodsS3      1.8.2         2022-06-13 [1] CRAN (R 4.2.0)
 R.oo             1.25.0        2022-06-12 [1] CRAN (R 4.2.0)
 R.utils          2.12.0        2022-06-28 [1] CRAN (R 4.2.1)
 R6               2.5.1.9000    2022-08-04 [1] Github (r-lib/R6@87d5e45)
 ragg             1.2.2.9000    2022-09-12 [1] Github (r-lib/ragg@904e145)
 RColorBrewer     1.1-3         2022-04-03 [1] CRAN (R 4.2.0)
 Rcpp             1.0.9         2022-07-08 [1] CRAN (R 4.2.1)
 readr          * 2.1.2.9000    2022-09-20 [1] Github (tidyverse/readr@5cac6ed)
 readxl           1.4.1.9000    2022-09-15 [1] Github (tidyverse/readxl@1835c96)
 remotes          2.4.2         2022-09-12 [1] Github (r-lib/remotes@bc0949d)
 reticulate       1.26          2022-08-31 [1] CRAN (R 4.2.1)
 rjson            0.2.21        2022-01-09 [1] CRAN (R 4.2.0)
 rlang            1.0.6         2022-09-24 [1] Github (r-lib/rlang@66454bd)
 rmarkdown        2.16.1        2022-09-24 [1] Github (rstudio/rmarkdown@9577707)
 Rttf2pt1         1.3.10        2022-02-07 [1] CRAN (R 4.2.0)
 S4Vectors        0.34.0        2022-04-26 [1] Bioconductor
 sass             0.4.2         2022-07-16 [1] CRAN (R 4.2.1)
 scales           1.2.1.9000    2022-08-20 [1] Github (r-lib/scales@b3df2fb)
 sessioninfo      1.2.2         2021-12-06 [1] CRAN (R 4.2.0)
 shape            1.4.6         2021-05-19 [1] CRAN (R 4.2.0)
 shiny            1.7.2         2022-07-19 [1] CRAN (R 4.2.1)
 stringi          1.7.8         2022-07-11 [1] CRAN (R 4.2.1)
 stringr        * 1.4.1.9000    2022-08-21 [1] Github (tidyverse/stringr@792bc92)
 styler         * 1.7.0.9002    2022-09-21 [1] Github (r-lib/styler@1f4437b)
 systemfonts      1.0.4         2022-02-11 [1] CRAN (R 4.2.0)
 textshaping      0.3.6         2021-10-13 [1] CRAN (R 4.2.0)
 tibble         * 3.1.8.9002    2022-09-24 [1] Github (tidyverse/tibble@e9db4f4)
 tidyr          * 1.2.1.9000    2022-09-09 [1] Github (tidyverse/tidyr@653def2)
 tidyselect       1.1.2.9000    2022-09-21 [1] Github (r-lib/tidyselect@edd0a3b)
 tidyverse      * 1.3.2.9000    2022-09-12 [1] Github (tidyverse/tidyverse@3be8283)
 tzdb             0.3.0         2022-03-28 [1] CRAN (R 4.2.0)
 urlchecker       1.0.1         2021-11-30 [1] CRAN (R 4.2.0)
 usethis          2.1.6.9000    2022-09-23 [1] Github (r-lib/usethis@8ecb7ab)
 utf8             1.2.2         2021-07-24 [1] CRAN (R 4.2.0)
 vctrs            0.4.1.9000    2022-09-19 [1] Github (r-lib/vctrs@0a219ba)
 vroom            1.5.7.9000    2022-09-09 [1] Github (r-lib/vroom@0c2423e)
 wesanderson      0.3.6.9000    2022-04-22 [1] Github (karthik/wesanderson@2796b59)
 withr            2.5.0         2022-03-03 [1] CRAN (R 4.2.0)
 xfun             0.33          2022-09-12 [1] CRAN (R 4.2.1)
 xtable           1.8-4         2019-04-21 [1] CRAN (R 4.2.0)
 yaml             2.3.5         2022-02-21 [1] CRAN (R 4.2.0)

 [1] /opt/homebrew/lib/R/4.2/site-library
 [2] /opt/homebrew/Cellar/r/4.2.1_4/lib/R/library

─ Python configuration ───────────────────────────────────────────────────────
 python:         /Users/jialei/.pyenv/shims/python
 libpython:      /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/libpython3.9.dylib
 pythonhome:     /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10:/Users/jialei/.pyenv/versions/mambaforge-4.10.3-10
 version:        3.9.13 | packaged by conda-forge | (main, May 27 2022, 17:00:33)  [Clang 13.0.1 ]
 numpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy
 numpy_version:  1.22.4
 numpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy
 
 NOTE: Python version was forced by RETICULATE_PYTHON

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">

</div>


</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@article{yu,
  author = {Leqian Yu and Yulei Wei and Jialei Duan and Daniel A.
    Schmitz and Masahiro Sakurai and Lei Wang and Kunhua Wang and Shuhua
    Zhao and Gary C. Hon and Jun Wu},
  editor = {},
  publisher = {Nature Publishing Group},
  title = {Blastocyst-Like Structures Generated from Human Pluripotent
    Stem Cells},
  journal = {Nature},
  volume = {591},
  number = {7851},
  pages = {620 - 626},
  date = {},
  url = {https://doi.org/10.1038/s41586-021-03356-y},
  doi = {10.1038/s41586-021-03356-y},
  langid = {en},
  abstract = {Human blastoids provide a readily accessible, scalable,
    versatile and perturbable alternative to blastocysts for studying
    early human development, understanding early pregnancy loss and
    gaining insights into early developmental defects.}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-yu" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Leqian Yu, Yulei Wei, Jialei Duan, Daniel A. Schmitz, Masahiro Sakurai,
Lei Wang, Kunhua Wang, Shuhua Zhao, Gary C. Hon, and Jun Wu. n.d.
<span>“Blastocyst-Like Structures Generated from Human Pluripotent Stem
Cells.”</span> <em>Nature</em> 591 (7851): 620–26. <a href="https://doi.org/10.1038/s41586-021-03356-y">https://doi.org/10.1038/s41586-021-03356-y</a>.
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/^(?:http:|https:)\/\/leafletjs\.com/);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./analyze_blastoids.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Interpret</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./miscellaneous.html" class="pagination-link">
        <span class="nav-page-text">Miscellaneous</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Copyright © 2022, Jialei Duan</div>   
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://github.com/jlduan/Human_blastoid/blob/master/LICENSE"><i class="fa-solid fa-file-lines" aria-hidden="true"></i> License</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="./about.html"><i class="fa-solid fa-circle-info" aria-hidden="true"></i> About</a>
  </li>  
</ul>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link active" href="https://twitter.com/jlduan" aria-current="page">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jlduan/Human_blastoid">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>